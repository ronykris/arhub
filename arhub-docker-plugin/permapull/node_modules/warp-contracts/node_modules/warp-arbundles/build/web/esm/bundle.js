var ni=Object.create;var ge=Object.defineProperty;var ii=Object.getOwnPropertyDescriptor;var si=Object.getOwnPropertyNames;var ai=Object.getPrototypeOf,oi=Object.prototype.hasOwnProperty;var ui=(r,t,e)=>t in r?ge(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var D=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),ci=(r,t)=>{for(var e in t)ge(r,e,{get:t[e],enumerable:!0})},fi=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of si(t))!oi.call(r,i)&&i!==e&&ge(r,i,{get:()=>t[i],enumerable:!(n=ii(t,i))||n.enumerable});return r};var Bt=(r,t,e)=>(e=r!=null?ni(ai(r)):{},fi(t||!r||!r.__esModule?ge(e,"default",{value:r,enumerable:!0}):e,r));var vt=(r,t,e)=>(ui(r,typeof t!="symbol"?t+"":t,e),e);var qr=D($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});function hi(r){var t=4,e=r.length,n=e%t;if(!n)return r;var i=e,a=t-n,u=e+a,y=Buffer.alloc(u);for(y.write(r);a--;)y.write("=",i++);return y.toString()}$e.default=hi});var Kr=D(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var li=qr();function Hr(r,t){return t===void 0&&(t="utf8"),Buffer.isBuffer(r)?qe(r.toString("base64")):qe(Buffer.from(r,t).toString("base64"))}function pi(r,t){return t===void 0&&(t="utf8"),Buffer.from(He(r),"base64").toString(t)}function He(r){return r=r.toString(),li.default(r).replace(/\-/g,"+").replace(/_/g,"/")}function qe(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function gi(r){return Buffer.from(He(r),"base64")}var Mt=Hr;Mt.encode=Hr;Mt.decode=pi;Mt.toBase64=He;Mt.fromBase64=qe;Mt.toBuffer=gi;Ke.default=Mt});var Yt=D((Fs,de)=>{de.exports=Kr().default;de.exports.default=de.exports});var Ge=D(we=>{"use strict";we.byteLength=wi;we.toByteArray=mi;we.fromByteArray=Bi;var wt=[],ht=[],di=typeof Uint8Array<"u"?Uint8Array:Array,je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(kt=0,jr=je.length;kt<jr;++kt)wt[kt]=je[kt],ht[je.charCodeAt(kt)]=kt;var kt,jr;ht["-".charCodeAt(0)]=62;ht["_".charCodeAt(0)]=63;function Gr(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");e===-1&&(e=t);var n=e===t?0:4-e%4;return[e,n]}function wi(r){var t=Gr(r),e=t[0],n=t[1];return(e+n)*3/4-n}function yi(r,t,e){return(t+e)*3/4-e}function mi(r){var t,e=Gr(r),n=e[0],i=e[1],a=new di(yi(r,n,i)),u=0,y=i>0?n-4:n,E;for(E=0;E<y;E+=4)t=ht[r.charCodeAt(E)]<<18|ht[r.charCodeAt(E+1)]<<12|ht[r.charCodeAt(E+2)]<<6|ht[r.charCodeAt(E+3)],a[u++]=t>>16&255,a[u++]=t>>8&255,a[u++]=t&255;return i===2&&(t=ht[r.charCodeAt(E)]<<2|ht[r.charCodeAt(E+1)]>>4,a[u++]=t&255),i===1&&(t=ht[r.charCodeAt(E)]<<10|ht[r.charCodeAt(E+1)]<<4|ht[r.charCodeAt(E+2)]>>2,a[u++]=t>>8&255,a[u++]=t&255),a}function xi(r){return wt[r>>18&63]+wt[r>>12&63]+wt[r>>6&63]+wt[r&63]}function Ei(r,t,e){for(var n,i=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(r[a+2]&255),i.push(xi(n));return i.join("")}function Bi(r){for(var t,e=r.length,n=e%3,i=[],a=16383,u=0,y=e-n;u<y;u+=a)i.push(Ei(r,u,u+a>y?y:u+a));return n===1?(t=r[e-1],i.push(wt[t>>2]+wt[t<<4&63]+"==")):n===2&&(t=(r[e-2]<<8)+r[e-1],i.push(wt[t>>10]+wt[t>>4&63]+wt[t<<2&63]+"=")),i.join("")}});var pt=D(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.b64UrlDecode=j.b64UrlEncode=j.bufferTob64Url=j.bufferTob64=j.b64UrlToBuffer=j.stringToB64Url=j.stringToBuffer=j.bufferToString=j.b64UrlToString=j.concatBuffers=void 0;var zr=Ge();function Ti(r){let t=0;for(let i=0;i<r.length;i++)t+=r[i].byteLength;let e=new Uint8Array(t),n=0;e.set(new Uint8Array(r[0]),n),n+=r[0].byteLength;for(let i=1;i<r.length;i++)e.set(new Uint8Array(r[i]),n),n+=r[i].byteLength;return e}j.concatBuffers=Ti;function Ai(r){let t=Jr(r);return Wr(t)}j.b64UrlToString=Ai;function Wr(r){return new TextDecoder("utf-8",{fatal:!0}).decode(r)}j.bufferToString=Wr;function Xr(r){return new TextEncoder().encode(r)}j.stringToBuffer=Xr;function _i(r){return Yr(Xr(r))}j.stringToB64Url=_i;function Jr(r){return new Uint8Array(zr.toByteArray(Qr(r)))}j.b64UrlToBuffer=Jr;function Vr(r){return zr.fromByteArray(new Uint8Array(r))}j.bufferTob64=Vr;function Yr(r){return Zr(Vr(r))}j.bufferTob64Url=Yr;function Zr(r){return r.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}j.b64UrlEncode=Zr;function Qr(r){r=r.replace(/\-/g,"+").replace(/\_/g,"/");let t;return r.length%4==0?t=0:t=4-r.length%4,r.concat("=".repeat(t))}j.b64UrlDecode=Qr});var Xe=D(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});var It=pt(),ze=class{keyLength=4096;publicExponent=65537;hashAlgorithm="sha256";driver;constructor(){if(!this.detectWebCrypto())throw new Error("SubtleCrypto not available!");this.driver=crypto.subtle}async generateJWK(){let t=await this.driver.generateKey({name:"RSA-PSS",modulusLength:4096,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign"]),e=await this.driver.exportKey("jwk",t.privateKey);return{kty:e.kty,e:e.e,n:e.n,d:e.d,p:e.p,q:e.q,dp:e.dp,dq:e.dq,qi:e.qi}}async sign(t,e,{saltLength:n}={}){let i=await this.driver.sign({name:"RSA-PSS",saltLength:32},await this.jwkToCryptoKey(t),e);return new Uint8Array(i)}async hash(t,e="SHA-256"){let n=await this.driver.digest(e,t);return new Uint8Array(n)}async verify(t,e,n){let i={kty:"RSA",e:"AQAB",n:t},a=await this.jwkToPublicCryptoKey(i),u=await this.driver.digest("SHA-256",e),y=await this.driver.verify({name:"RSA-PSS",saltLength:0},a,n,e),E=await this.driver.verify({name:"RSA-PSS",saltLength:32},a,n,e),b=await this.driver.verify({name:"RSA-PSS",saltLength:Math.ceil((a.algorithm.modulusLength-1)/8)-u.byteLength-2},a,n,e);return y||E||b}async jwkToCryptoKey(t){return this.driver.importKey("jwk",t,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["sign"])}async jwkToPublicCryptoKey(t){return this.driver.importKey("jwk",t,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["verify"])}detectWebCrypto(){if(typeof crypto>"u")return!1;let t=crypto?.subtle;return t===void 0?!1:["generateKey","importKey","exportKey","digest","sign"].every(n=>typeof t[n]=="function")}async encrypt(t,e,n){let i=await this.driver.importKey("raw",typeof e=="string"?It.stringToBuffer(e):e,{name:"PBKDF2",length:32},!1,["deriveKey"]),a=await this.driver.deriveKey({name:"PBKDF2",salt:n?It.stringToBuffer(n):It.stringToBuffer("salt"),iterations:1e5,hash:"SHA-256"},i,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"]),u=new Uint8Array(16);crypto.getRandomValues(u);let y=await this.driver.encrypt({name:"AES-CBC",iv:u},a,t);return It.concatBuffers([u,y])}async decrypt(t,e,n){let i=await this.driver.importKey("raw",typeof e=="string"?It.stringToBuffer(e):e,{name:"PBKDF2",length:32},!1,["deriveKey"]),a=await this.driver.deriveKey({name:"PBKDF2",salt:n?It.stringToBuffer(n):It.stringToBuffer("salt"),iterations:1e5,hash:"SHA-256"},i,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"]),u=t.slice(0,16),y=await this.driver.decrypt({name:"AES-CBC",iv:u},a,t.slice(16));return It.concatBuffers([y])}};We.default=ze});var nn=D((rn,xe)=>{(function(r){"use strict";var t,e=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,i=Math.floor,a="[BigNumber Error] ",u=a+"Number primitive has more than 15 significant digits: ",y=1e14,E=14,b=9007199254740991,I=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],_=1e7,C=1e9;function F(N){var L,$,z,A=T.prototype={constructor:T,toString:null,valueOf:null},W=new T(1),M=20,q=4,nt=-7,st=21,Nt=-1e7,lt=1e7,Rt=!1,Jt=1,St=0,ke={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Ot="0123456789abcdefghijklmnopqrstuvwxyz",Ce=!0;function T(s,o){var c,d,h,p,m,f,l,w,g=this;if(!(g instanceof T))return new T(s,o);if(o==null){if(s&&s._isBigNumber===!0){g.s=s.s,!s.c||s.e>lt?g.c=g.e=null:s.e<Nt?g.c=[g.e=0]:(g.e=s.e,g.c=s.c.slice());return}if((f=typeof s=="number")&&s*0==0){if(g.s=1/s<0?(s=-s,-1):1,s===~~s){for(p=0,m=s;m>=10;m/=10,p++);p>lt?g.c=g.e=null:(g.e=p,g.c=[s]);return}w=String(s)}else{if(!e.test(w=String(s)))return z(g,w,f);g.s=w.charCodeAt(0)==45?(w=w.slice(1),-1):1}(p=w.indexOf("."))>-1&&(w=w.replace(".","")),(m=w.search(/e/i))>0?(p<0&&(p=m),p+=+w.slice(m+1),w=w.substring(0,m)):p<0&&(p=w.length)}else{if(v(o,2,Ot.length,"Base"),o==10&&Ce)return g=new T(s),ct(g,M+g.e+1,q);if(w=String(s),f=typeof s=="number"){if(s*0!=0)return z(g,w,f,o);if(g.s=1/s<0?(w=w.slice(1),-1):1,T.DEBUG&&w.replace(/^0\.0*|\./,"").length>15)throw Error(u+s)}else g.s=w.charCodeAt(0)===45?(w=w.slice(1),-1):1;for(c=Ot.slice(0,o),p=m=0,l=w.length;m<l;m++)if(c.indexOf(d=w.charAt(m))<0){if(d=="."){if(m>p){p=l;continue}}else if(!h&&(w==w.toUpperCase()&&(w=w.toLowerCase())||w==w.toLowerCase()&&(w=w.toUpperCase()))){h=!0,m=-1,p=0;continue}return z(g,String(s),f,o)}f=!1,w=$(w,o,10,g.s),(p=w.indexOf("."))>-1?w=w.replace(".",""):p=w.length}for(m=0;w.charCodeAt(m)===48;m++);for(l=w.length;w.charCodeAt(--l)===48;);if(w=w.slice(m,++l)){if(l-=m,f&&T.DEBUG&&l>15&&(s>b||s!==i(s)))throw Error(u+g.s*s);if((p=p-m-1)>lt)g.c=g.e=null;else if(p<Nt)g.c=[g.e=0];else{if(g.e=p,g.c=[],m=(p+1)%E,p<0&&(m+=E),m<l){for(m&&g.c.push(+w.slice(0,m)),l-=E;m<l;)g.c.push(+w.slice(m,m+=E));m=E-(w=w.slice(m)).length}else m-=l;for(;m--;w+="0");g.c.push(+w)}}else g.c=[g.e=0]}T.clone=F,T.ROUND_UP=0,T.ROUND_DOWN=1,T.ROUND_CEIL=2,T.ROUND_FLOOR=3,T.ROUND_HALF_UP=4,T.ROUND_HALF_DOWN=5,T.ROUND_HALF_EVEN=6,T.ROUND_HALF_CEIL=7,T.ROUND_HALF_FLOOR=8,T.EUCLID=9,T.config=T.set=function(s){var o,c;if(s!=null)if(typeof s=="object"){if(s.hasOwnProperty(o="DECIMAL_PLACES")&&(c=s[o],v(c,0,C,o),M=c),s.hasOwnProperty(o="ROUNDING_MODE")&&(c=s[o],v(c,0,8,o),q=c),s.hasOwnProperty(o="EXPONENTIAL_AT")&&(c=s[o],c&&c.pop?(v(c[0],-C,0,o),v(c[1],0,C,o),nt=c[0],st=c[1]):(v(c,-C,C,o),nt=-(st=c<0?-c:c))),s.hasOwnProperty(o="RANGE"))if(c=s[o],c&&c.pop)v(c[0],-C,-1,o),v(c[1],1,C,o),Nt=c[0],lt=c[1];else if(v(c,-C,C,o),c)Nt=-(lt=c<0?-c:c);else throw Error(a+o+" cannot be zero: "+c);if(s.hasOwnProperty(o="CRYPTO"))if(c=s[o],c===!!c)if(c)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Rt=c;else throw Rt=!c,Error(a+"crypto unavailable");else Rt=c;else throw Error(a+o+" not true or false: "+c);if(s.hasOwnProperty(o="MODULO_MODE")&&(c=s[o],v(c,0,9,o),Jt=c),s.hasOwnProperty(o="POW_PRECISION")&&(c=s[o],v(c,0,C,o),St=c),s.hasOwnProperty(o="FORMAT"))if(c=s[o],typeof c=="object")ke=c;else throw Error(a+o+" not an object: "+c);if(s.hasOwnProperty(o="ALPHABET"))if(c=s[o],typeof c=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(c))Ce=c.slice(0,10)=="0123456789",Ot=c;else throw Error(a+o+" invalid: "+c)}else throw Error(a+"Object expected: "+s);return{DECIMAL_PLACES:M,ROUNDING_MODE:q,EXPONENTIAL_AT:[nt,st],RANGE:[Nt,lt],CRYPTO:Rt,MODULO_MODE:Jt,POW_PRECISION:St,FORMAT:ke,ALPHABET:Ot}},T.isBigNumber=function(s){if(!s||s._isBigNumber!==!0)return!1;if(!T.DEBUG)return!0;var o,c,d=s.c,h=s.e,p=s.s;t:if({}.toString.call(d)=="[object Array]"){if((p===1||p===-1)&&h>=-C&&h<=C&&h===i(h)){if(d[0]===0){if(h===0&&d.length===1)return!0;break t}if(o=(h+1)%E,o<1&&(o+=E),String(d[0]).length==o){for(o=0;o<d.length;o++)if(c=d[o],c<0||c>=y||c!==i(c))break t;if(c!==0)return!0}}}else if(d===null&&h===null&&(p===null||p===1||p===-1))return!0;throw Error(a+"Invalid BigNumber: "+s)},T.maximum=T.max=function(){return $r(arguments,A.lt)},T.minimum=T.min=function(){return $r(arguments,A.gt)},T.random=function(){var s=9007199254740992,o=Math.random()*s&2097151?function(){return i(Math.random()*s)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(c){var d,h,p,m,f,l=0,w=[],g=new T(W);if(c==null?c=M:v(c,0,C),m=n(c/E),Rt)if(crypto.getRandomValues){for(d=crypto.getRandomValues(new Uint32Array(m*=2));l<m;)f=d[l]*131072+(d[l+1]>>>11),f>=9e15?(h=crypto.getRandomValues(new Uint32Array(2)),d[l]=h[0],d[l+1]=h[1]):(w.push(f%1e14),l+=2);l=m/2}else if(crypto.randomBytes){for(d=crypto.randomBytes(m*=7);l<m;)f=(d[l]&31)*281474976710656+d[l+1]*1099511627776+d[l+2]*4294967296+d[l+3]*16777216+(d[l+4]<<16)+(d[l+5]<<8)+d[l+6],f>=9e15?crypto.randomBytes(7).copy(d,l):(w.push(f%1e14),l+=7);l=m/7}else throw Rt=!1,Error(a+"crypto unavailable");if(!Rt)for(;l<m;)f=o(),f<9e15&&(w[l++]=f%1e14);for(m=w[--l],c%=E,m&&c&&(f=I[E-c],w[l]=i(m/f)*f);w[l]===0;w.pop(),l--);if(l<0)w=[p=0];else{for(p=-1;w[0]===0;w.splice(0,1),p-=E);for(l=1,f=w[0];f>=10;f/=10,l++);l<E&&(p-=E-l)}return g.e=p,g.c=w,g}}(),T.sum=function(){for(var s=1,o=arguments,c=new T(o[0]);s<o.length;)c=c.plus(o[s++]);return c},$=function(){var s="0123456789";function o(c,d,h,p){for(var m,f=[0],l,w=0,g=c.length;w<g;){for(l=f.length;l--;f[l]*=d);for(f[0]+=p.indexOf(c.charAt(w++)),m=0;m<f.length;m++)f[m]>h-1&&(f[m+1]==null&&(f[m+1]=0),f[m+1]+=f[m]/h|0,f[m]%=h)}return f.reverse()}return function(c,d,h,p,m){var f,l,w,g,B,S,U,k,H=c.indexOf("."),X=M,O=q;for(H>=0&&(g=St,St=0,c=c.replace(".",""),k=new T(d),S=k.pow(c.length-H),St=g,k.c=o(xt(V(S.c),S.e,"0"),10,h,s),k.e=k.c.length),U=o(c,d,h,m?(f=Ot,s):(f=s,Ot)),w=g=U.length;U[--g]==0;U.pop());if(!U[0])return f.charAt(0);if(H<0?--w:(S.c=U,S.e=w,S.s=p,S=L(S,k,X,O,h),U=S.c,B=S.r,w=S.e),l=w+X+1,H=U[l],g=h/2,B=B||l<0||U[l+1]!=null,B=O<4?(H!=null||B)&&(O==0||O==(S.s<0?3:2)):H>g||H==g&&(O==4||B||O==6&&U[l-1]&1||O==(S.s<0?8:7)),l<1||!U[0])c=B?xt(f.charAt(1),-X,f.charAt(0)):f.charAt(0);else{if(U.length=l,B)for(--h;++U[--l]>h;)U[l]=0,l||(++w,U=[1].concat(U));for(g=U.length;!U[--g];);for(H=0,c="";H<=g;c+=f.charAt(U[H++]));c=xt(c,w,f.charAt(0))}return c}}(),L=function(){function s(d,h,p){var m,f,l,w,g=0,B=d.length,S=h%_,U=h/_|0;for(d=d.slice();B--;)l=d[B]%_,w=d[B]/_|0,m=U*l+w*S,f=S*l+m%_*_+g,g=(f/p|0)+(m/_|0)+U*w,d[B]=f%p;return g&&(d=[g].concat(d)),d}function o(d,h,p,m){var f,l;if(p!=m)l=p>m?1:-1;else for(f=l=0;f<p;f++)if(d[f]!=h[f]){l=d[f]>h[f]?1:-1;break}return l}function c(d,h,p,m){for(var f=0;p--;)d[p]-=f,f=d[p]<h[p]?1:0,d[p]=f*m+d[p]-h[p];for(;!d[0]&&d.length>1;d.splice(0,1));}return function(d,h,p,m,f){var l,w,g,B,S,U,k,H,X,O,P,Q,pe,De,ve,dt,Vt,ft=d.s==h.s?1:-1,et=d.c,K=h.c;if(!et||!et[0]||!K||!K[0])return new T(!d.s||!h.s||(et?K&&et[0]==K[0]:!K)?NaN:et&&et[0]==0||!K?ft*0:ft/0);for(H=new T(ft),X=H.c=[],w=d.e-h.e,ft=p+w+1,f||(f=y,w=G(d.e/E)-G(h.e/E),ft=ft/E|0),g=0;K[g]==(et[g]||0);g++);if(K[g]>(et[g]||0)&&w--,ft<0)X.push(1),B=!0;else{for(De=et.length,dt=K.length,g=0,ft+=2,S=i(f/(K[0]+1)),S>1&&(K=s(K,S,f),et=s(et,S,f),dt=K.length,De=et.length),pe=dt,O=et.slice(0,dt),P=O.length;P<dt;O[P++]=0);Vt=K.slice(),Vt=[0].concat(Vt),ve=K[0],K[1]>=f/2&&ve++;do{if(S=0,l=o(K,O,dt,P),l<0){if(Q=O[0],dt!=P&&(Q=Q*f+(O[1]||0)),S=i(Q/ve),S>1)for(S>=f&&(S=f-1),U=s(K,S,f),k=U.length,P=O.length;o(U,O,k,P)==1;)S--,c(U,dt<k?Vt:K,k,f),k=U.length,l=1;else S==0&&(l=S=1),U=K.slice(),k=U.length;if(k<P&&(U=[0].concat(U)),c(O,U,P,f),P=O.length,l==-1)for(;o(K,O,dt,P)<1;)S++,c(O,dt<P?Vt:K,P,f),P=O.length}else l===0&&(S++,O=[0]);X[g++]=S,O[0]?O[P++]=et[pe]||0:(O=[et[pe]],P=1)}while((pe++<De||O[0]!=null)&&ft--);B=O[0]!=null,X[0]||X.splice(0,1)}if(f==y){for(g=1,ft=X[0];ft>=10;ft/=10,g++);ct(H,p+(H.e=g+w*E-1)+1,m,B)}else H.e=w,H.r=+B;return H}}();function Fe(s,o,c,d){var h,p,m,f,l;if(c==null?c=q:v(c,0,8),!s.c)return s.toString();if(h=s.c[0],m=s.e,o==null)l=V(s.c),l=d==1||d==2&&(m<=nt||m>=st)?le(l,m):xt(l,m,"0");else if(s=ct(new T(s),o,c),p=s.e,l=V(s.c),f=l.length,d==1||d==2&&(o<=p||p<=nt)){for(;f<o;l+="0",f++);l=le(l,p)}else if(o-=m,l=xt(l,p,"0"),p+1>f){if(--o>0)for(l+=".";o--;l+="0");}else if(o+=p-f,o>0)for(p+1==f&&(l+=".");o--;l+="0");return s.s<0&&h?"-"+l:l}function $r(s,o){for(var c,d=1,h=new T(s[0]);d<s.length;d++)if(c=new T(s[d]),c.s)o.call(h,c)&&(h=c);else{h=c;break}return h}function Pe(s,o,c){for(var d=1,h=o.length;!o[--h];o.pop());for(h=o[0];h>=10;h/=10,d++);return(c=d+c*E-1)>lt?s.c=s.e=null:c<Nt?s.c=[s.e=0]:(s.e=c,s.c=o),s}z=function(){var s=/^(-?)0([xbo])(?=\w[\w.]*$)/i,o=/^([^.]+)\.$/,c=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,h=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(p,m,f,l){var w,g=f?m:m.replace(h,"");if(d.test(g))p.s=isNaN(g)?null:g<0?-1:1;else{if(!f&&(g=g.replace(s,function(B,S,U){return w=(U=U.toLowerCase())=="x"?16:U=="b"?2:8,!l||l==w?S:B}),l&&(w=l,g=g.replace(o,"$1").replace(c,"0.$1")),m!=g))return new T(g,w);if(T.DEBUG)throw Error(a+"Not a"+(l?" base "+l:"")+" number: "+m);p.s=null}p.c=p.e=null}}();function ct(s,o,c,d){var h,p,m,f,l,w,g,B=s.c,S=I;if(B){t:{for(h=1,f=B[0];f>=10;f/=10,h++);if(p=o-h,p<0)p+=E,m=o,l=B[w=0],g=l/S[h-m-1]%10|0;else if(w=n((p+1)/E),w>=B.length)if(d){for(;B.length<=w;B.push(0));l=g=0,h=1,p%=E,m=p-E+1}else break t;else{for(l=f=B[w],h=1;f>=10;f/=10,h++);p%=E,m=p-E+h,g=m<0?0:l/S[h-m-1]%10|0}if(d=d||o<0||B[w+1]!=null||(m<0?l:l%S[h-m-1]),d=c<4?(g||d)&&(c==0||c==(s.s<0?3:2)):g>5||g==5&&(c==4||d||c==6&&(p>0?m>0?l/S[h-m]:0:B[w-1])%10&1||c==(s.s<0?8:7)),o<1||!B[0])return B.length=0,d?(o-=s.e+1,B[0]=S[(E-o%E)%E],s.e=-o||0):B[0]=s.e=0,s;if(p==0?(B.length=w,f=1,w--):(B.length=w+1,f=S[E-p],B[w]=m>0?i(l/S[h-m]%S[m])*f:0),d)for(;;)if(w==0){for(p=1,m=B[0];m>=10;m/=10,p++);for(m=B[0]+=f,f=1;m>=10;m/=10,f++);p!=f&&(s.e++,B[0]==y&&(B[0]=1));break}else{if(B[w]+=f,B[w]!=y)break;B[w--]=0,f=1}for(p=B.length;B[--p]===0;B.pop());}s.e>lt?s.c=s.e=null:s.e<Nt&&(s.c=[s.e=0])}return s}function Et(s){var o,c=s.e;return c===null?s.toString():(o=V(s.c),o=c<=nt||c>=st?le(o,c):xt(o,c,"0"),s.s<0?"-"+o:o)}return A.absoluteValue=A.abs=function(){var s=new T(this);return s.s<0&&(s.s=1),s},A.comparedTo=function(s,o){return ut(this,new T(s,o))},A.decimalPlaces=A.dp=function(s,o){var c,d,h,p=this;if(s!=null)return v(s,0,C),o==null?o=q:v(o,0,8),ct(new T(p),s+p.e+1,o);if(!(c=p.c))return null;if(d=((h=c.length-1)-G(this.e/E))*E,h=c[h])for(;h%10==0;h/=10,d--);return d<0&&(d=0),d},A.dividedBy=A.div=function(s,o){return L(this,new T(s,o),M,q)},A.dividedToIntegerBy=A.idiv=function(s,o){return L(this,new T(s,o),0,1)},A.exponentiatedBy=A.pow=function(s,o){var c,d,h,p,m,f,l,w,g,B=this;if(s=new T(s),s.c&&!s.isInteger())throw Error(a+"Exponent not an integer: "+Et(s));if(o!=null&&(o=new T(o)),f=s.e>14,!B.c||!B.c[0]||B.c[0]==1&&!B.e&&B.c.length==1||!s.c||!s.c[0])return g=new T(Math.pow(+Et(B),f?s.s*(2-Dt(s)):+Et(s))),o?g.mod(o):g;if(l=s.s<0,o){if(o.c?!o.c[0]:!o.s)return new T(NaN);d=!l&&B.isInteger()&&o.isInteger(),d&&(B=B.mod(o))}else{if(s.e>9&&(B.e>0||B.e<-1||(B.e==0?B.c[0]>1||f&&B.c[1]>=24e7:B.c[0]<8e13||f&&B.c[0]<=9999975e7)))return p=B.s<0&&Dt(s)?-0:0,B.e>-1&&(p=1/p),new T(l?1/p:p);St&&(p=n(St/E+2))}for(f?(c=new T(.5),l&&(s.s=1),w=Dt(s)):(h=Math.abs(+Et(s)),w=h%2),g=new T(W);;){if(w){if(g=g.times(B),!g.c)break;p?g.c.length>p&&(g.c.length=p):d&&(g=g.mod(o))}if(h){if(h=i(h/2),h===0)break;w=h%2}else if(s=s.times(c),ct(s,s.e+1,1),s.e>14)w=Dt(s);else{if(h=+Et(s),h===0)break;w=h%2}B=B.times(B),p?B.c&&B.c.length>p&&(B.c.length=p):d&&(B=B.mod(o))}return d?g:(l&&(g=W.div(g)),o?g.mod(o):p?ct(g,St,q,m):g)},A.integerValue=function(s){var o=new T(this);return s==null?s=q:v(s,0,8),ct(o,o.e+1,s)},A.isEqualTo=A.eq=function(s,o){return ut(this,new T(s,o))===0},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(s,o){return ut(this,new T(s,o))>0},A.isGreaterThanOrEqualTo=A.gte=function(s,o){return(o=ut(this,new T(s,o)))===1||o===0},A.isInteger=function(){return!!this.c&&G(this.e/E)>this.c.length-2},A.isLessThan=A.lt=function(s,o){return ut(this,new T(s,o))<0},A.isLessThanOrEqualTo=A.lte=function(s,o){return(o=ut(this,new T(s,o)))===-1||o===0},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&this.c[0]==0},A.minus=function(s,o){var c,d,h,p,m=this,f=m.s;if(s=new T(s,o),o=s.s,!f||!o)return new T(NaN);if(f!=o)return s.s=-o,m.plus(s);var l=m.e/E,w=s.e/E,g=m.c,B=s.c;if(!l||!w){if(!g||!B)return g?(s.s=-o,s):new T(B?m:NaN);if(!g[0]||!B[0])return B[0]?(s.s=-o,s):new T(g[0]?m:q==3?-0:0)}if(l=G(l),w=G(w),g=g.slice(),f=l-w){for((p=f<0)?(f=-f,h=g):(w=l,h=B),h.reverse(),o=f;o--;h.push(0));h.reverse()}else for(d=(p=(f=g.length)<(o=B.length))?f:o,f=o=0;o<d;o++)if(g[o]!=B[o]){p=g[o]<B[o];break}if(p&&(h=g,g=B,B=h,s.s=-s.s),o=(d=B.length)-(c=g.length),o>0)for(;o--;g[c++]=0);for(o=y-1;d>f;){if(g[--d]<B[d]){for(c=d;c&&!g[--c];g[c]=o);--g[c],g[d]+=y}g[d]-=B[d]}for(;g[0]==0;g.splice(0,1),--w);return g[0]?Pe(s,g,w):(s.s=q==3?-1:1,s.c=[s.e=0],s)},A.modulo=A.mod=function(s,o){var c,d,h=this;return s=new T(s,o),!h.c||!s.s||s.c&&!s.c[0]?new T(NaN):!s.c||h.c&&!h.c[0]?new T(h):(Jt==9?(d=s.s,s.s=1,c=L(h,s,0,3),s.s=d,c.s*=d):c=L(h,s,0,Jt),s=h.minus(c.times(s)),!s.c[0]&&Jt==1&&(s.s=h.s),s)},A.multipliedBy=A.times=function(s,o){var c,d,h,p,m,f,l,w,g,B,S,U,k,H,X,O=this,P=O.c,Q=(s=new T(s,o)).c;if(!P||!Q||!P[0]||!Q[0])return!O.s||!s.s||P&&!P[0]&&!Q||Q&&!Q[0]&&!P?s.c=s.e=s.s=null:(s.s*=O.s,!P||!Q?s.c=s.e=null:(s.c=[0],s.e=0)),s;for(d=G(O.e/E)+G(s.e/E),s.s*=O.s,l=P.length,B=Q.length,l<B&&(k=P,P=Q,Q=k,h=l,l=B,B=h),h=l+B,k=[];h--;k.push(0));for(H=y,X=_,h=B;--h>=0;){for(c=0,S=Q[h]%X,U=Q[h]/X|0,m=l,p=h+m;p>h;)w=P[--m]%X,g=P[m]/X|0,f=U*w+g*S,w=S*w+f%X*X+k[p]+c,c=(w/H|0)+(f/X|0)+U*g,k[p--]=w%H;k[p]=c}return c?++d:k.splice(0,1),Pe(s,k,d)},A.negated=function(){var s=new T(this);return s.s=-s.s||null,s},A.plus=function(s,o){var c,d=this,h=d.s;if(s=new T(s,o),o=s.s,!h||!o)return new T(NaN);if(h!=o)return s.s=-o,d.minus(s);var p=d.e/E,m=s.e/E,f=d.c,l=s.c;if(!p||!m){if(!f||!l)return new T(h/0);if(!f[0]||!l[0])return l[0]?s:new T(f[0]?d:h*0)}if(p=G(p),m=G(m),f=f.slice(),h=p-m){for(h>0?(m=p,c=l):(h=-h,c=f),c.reverse();h--;c.push(0));c.reverse()}for(h=f.length,o=l.length,h-o<0&&(c=l,l=f,f=c,o=h),h=0;o;)h=(f[--o]=f[o]+l[o]+h)/y|0,f[o]=y===f[o]?0:f[o]%y;return h&&(f=[h].concat(f),++m),Pe(s,f,m)},A.precision=A.sd=function(s,o){var c,d,h,p=this;if(s!=null&&s!==!!s)return v(s,1,C),o==null?o=q:v(o,0,8),ct(new T(p),s,o);if(!(c=p.c))return null;if(h=c.length-1,d=h*E+1,h=c[h]){for(;h%10==0;h/=10,d--);for(h=c[0];h>=10;h/=10,d++);}return s&&p.e+1>d&&(d=p.e+1),d},A.shiftedBy=function(s){return v(s,-b,b),this.times("1e"+s)},A.squareRoot=A.sqrt=function(){var s,o,c,d,h,p=this,m=p.c,f=p.s,l=p.e,w=M+4,g=new T("0.5");if(f!==1||!m||!m[0])return new T(!f||f<0&&(!m||m[0])?NaN:m?p:1/0);if(f=Math.sqrt(+Et(p)),f==0||f==1/0?(o=V(m),(o.length+l)%2==0&&(o+="0"),f=Math.sqrt(+o),l=G((l+1)/2)-(l<0||l%2),f==1/0?o="5e"+l:(o=f.toExponential(),o=o.slice(0,o.indexOf("e")+1)+l),c=new T(o)):c=new T(f+""),c.c[0]){for(l=c.e,f=l+w,f<3&&(f=0);;)if(h=c,c=g.times(h.plus(L(p,h,w,1))),V(h.c).slice(0,f)===(o=V(c.c)).slice(0,f))if(c.e<l&&--f,o=o.slice(f-3,f+1),o=="9999"||!d&&o=="4999"){if(!d&&(ct(h,h.e+M+2,0),h.times(h).eq(p))){c=h;break}w+=4,f+=4,d=1}else{(!+o||!+o.slice(1)&&o.charAt(0)=="5")&&(ct(c,c.e+M+2,1),s=!c.times(c).eq(p));break}}return ct(c,c.e+M+1,q,s)},A.toExponential=function(s,o){return s!=null&&(v(s,0,C),s++),Fe(this,s,o,1)},A.toFixed=function(s,o){return s!=null&&(v(s,0,C),s=s+this.e+1),Fe(this,s,o)},A.toFormat=function(s,o,c){var d,h=this;if(c==null)s!=null&&o&&typeof o=="object"?(c=o,o=null):s&&typeof s=="object"?(c=s,s=o=null):c=ke;else if(typeof c!="object")throw Error(a+"Argument not an object: "+c);if(d=h.toFixed(s,o),h.c){var p,m=d.split("."),f=+c.groupSize,l=+c.secondaryGroupSize,w=c.groupSeparator||"",g=m[0],B=m[1],S=h.s<0,U=S?g.slice(1):g,k=U.length;if(l&&(p=f,f=l,l=p,k-=p),f>0&&k>0){for(p=k%f||f,g=U.substr(0,p);p<k;p+=f)g+=w+U.substr(p,f);l>0&&(g+=w+U.slice(p)),S&&(g="-"+g)}d=B?g+(c.decimalSeparator||"")+((l=+c.fractionGroupSize)?B.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(c.fractionGroupSeparator||"")):B):g}return(c.prefix||"")+d+(c.suffix||"")},A.toFraction=function(s){var o,c,d,h,p,m,f,l,w,g,B,S,U=this,k=U.c;if(s!=null&&(f=new T(s),!f.isInteger()&&(f.c||f.s!==1)||f.lt(W)))throw Error(a+"Argument "+(f.isInteger()?"out of range: ":"not an integer: ")+Et(f));if(!k)return new T(U);for(o=new T(W),w=c=new T(W),d=l=new T(W),S=V(k),p=o.e=S.length-U.e-1,o.c[0]=I[(m=p%E)<0?E+m:m],s=!s||f.comparedTo(o)>0?p>0?o:w:f,m=lt,lt=1/0,f=new T(S),l.c[0]=0;g=L(f,o,0,1),h=c.plus(g.times(d)),h.comparedTo(s)!=1;)c=d,d=h,w=l.plus(g.times(h=w)),l=h,o=f.minus(g.times(h=o)),f=h;return h=L(s.minus(c),d,0,1),l=l.plus(h.times(w)),c=c.plus(h.times(d)),l.s=w.s=U.s,p=p*2,B=L(w,d,p,q).minus(U).abs().comparedTo(L(l,c,p,q).minus(U).abs())<1?[w,d]:[l,c],lt=m,B},A.toNumber=function(){return+Et(this)},A.toPrecision=function(s,o){return s!=null&&v(s,1,C),Fe(this,s,o,2)},A.toString=function(s){var o,c=this,d=c.s,h=c.e;return h===null?d?(o="Infinity",d<0&&(o="-"+o)):o="NaN":(s==null?o=h<=nt||h>=st?le(V(c.c),h):xt(V(c.c),h,"0"):s===10&&Ce?(c=ct(new T(c),M+h+1,q),o=xt(V(c.c),c.e,"0")):(v(s,2,Ot.length,"Base"),o=$(xt(V(c.c),h,"0"),10,s,d,!0)),d<0&&c.c[0]&&(o="-"+o)),o},A.valueOf=A.toJSON=function(){return Et(this)},A._isBigNumber=!0,N!=null&&T.set(N),T}function G(N){var L=N|0;return N>0||N===L?L:L-1}function V(N){for(var L,$,z=1,A=N.length,W=N[0]+"";z<A;){for(L=N[z++]+"",$=E-L.length;$--;L="0"+L);W+=L}for(A=W.length;W.charCodeAt(--A)===48;);return W.slice(0,A+1||1)}function ut(N,L){var $,z,A=N.c,W=L.c,M=N.s,q=L.s,nt=N.e,st=L.e;if(!M||!q)return null;if($=A&&!A[0],z=W&&!W[0],$||z)return $?z?0:-q:M;if(M!=q)return M;if($=M<0,z=nt==st,!A||!W)return z?0:!A^$?1:-1;if(!z)return nt>st^$?1:-1;for(q=(nt=A.length)<(st=W.length)?nt:st,M=0;M<q;M++)if(A[M]!=W[M])return A[M]>W[M]^$?1:-1;return nt==st?0:nt>st^$?1:-1}function v(N,L,$,z){if(N<L||N>$||N!==i(N))throw Error(a+(z||"Argument")+(typeof N=="number"?N<L||N>$?" out of range: ":" not an integer: ":" not a primitive number: ")+String(N))}function Dt(N){var L=N.c.length-1;return G(N.e/E)==L&&N.c[L]%2!=0}function le(N,L){return(N.length>1?N.charAt(0)+"."+N.slice(1):N)+(L<0?"e":"e+")+L}function xt(N,L,$){var z,A;if(L<0){for(A=$+".";++L;A+=$);N=A+N}else if(z=N.length,++L>z){for(A=$,L-=z;--L;A+=$);N+=A}else L<z&&(N=N.slice(0,L)+"."+N.slice(L));return N}t=F(),t.default=t.BigNumber=t,typeof define=="function"&&define.amd?define(function(){return t}):typeof xe<"u"&&xe.exports?xe.exports=t:(r||(r=typeof self<"u"&&self?self:window),r.BigNumber=t)})(rn)});var sn=D(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});var Ii=nn(),Ye=class{BigNum;constructor(){this.BigNum=(t,e)=>{let n=Ii.BigNumber.clone({DECIMAL_PLACES:e});return new n(t)}}winstonToAr(t,{formatted:e=!1,decimals:n=12,trim:i=!0}={}){let a=this.stringToBigNum(t,n).shiftedBy(-12);return e?a.toFormat(n):a.toFixed(n)}arToWinston(t,{formatted:e=!1}={}){let n=this.stringToBigNum(t).shiftedBy(12);return e?n.toFormat():n.toFixed(0)}compare(t,e){let n=this.stringToBigNum(t),i=this.stringToBigNum(e);return n.comparedTo(i)}isEqual(t,e){return this.compare(t,e)===0}isLessThan(t,e){let n=this.stringToBigNum(t),i=this.stringToBigNum(e);return n.isLessThan(i)}isGreaterThan(t,e){let n=this.stringToBigNum(t),i=this.stringToBigNum(e);return n.isGreaterThan(i)}add(t,e){let n=this.stringToBigNum(t),i=this.stringToBigNum(e);return n.plus(e).toFixed(0)}sub(t,e){let n=this.stringToBigNum(t),i=this.stringToBigNum(e);return n.minus(e).toFixed(0)}stringToBigNum(t,e=12){return this.BigNum(t,e)}};Ze.default=Ye});var an=D(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});var Qe=class{METHOD_GET="GET";METHOD_POST="POST";config;constructor(t){this.applyConfig(t)}applyConfig(t){this.config=this.mergeDefaults(t)}getConfig(){return this.config}mergeDefaults(t){let e=t.protocol||"http",n=t.port||(e==="https"?443:80);return{host:t.host||"127.0.0.1",protocol:e,port:n,timeout:t.timeout||2e4,logging:t.logging||!1,logger:t.logger||console.log,network:t.network}}async get(t,e){return await this.request(t,{...e,method:this.METHOD_GET})}async post(t,e,n){let i=new Headers(n?.headers||{});return i.get("content-type")?.includes("application/json")||i.append("content-type","application/json"),i.append("accept","application/json, text/plain, */*"),await this.request(t,{...n,method:this.METHOD_POST,body:typeof e!="string"?JSON.stringify(e):e,headers:i})}async request(t,e){let n=new Headers(e?.headers||{}),i=`${this.config.protocol}://${this.config.host}:${this.config.port}`,a=e?.responseType;delete e?.responseType,t.startsWith("/")&&(t=t.slice(1)),this.config.network&&n.append("x-network",this.config.network),this.config.logging&&this.config.logger(`Requesting: ${i}/${t}`);let u=await fetch(`${i}/${t}`,{...e||{},headers:n});this.config.logging&&this.config.logger(`Response:   ${u.url} - ${u.status}`);let E=u.headers.get("content-type")?.match(/charset=([^()<>@,;:\"/[\]?.=\s]*)/i)?.[1],b=u,I=async()=>{if(E)try{b.data=new TextDecoder(E).decode(await u.arrayBuffer())}catch{b.data=await u.text()}else b.data=await u.text()};if(a==="arraybuffer")b.data=await u.arrayBuffer();else if(a==="text")await I();else if(a==="webstream")b.data=Ui(u.body);else try{let _=await u.clone().json();typeof _!="object"?await I():b.data=await u.json(),_=null}catch{await I()}return b}};tr.default=Qe;var Ui=r=>{let t=r;return typeof t[Symbol.asyncIterator]>"u"?(t[Symbol.asyncIterator]=Li(r),t):r},Li=function(r){return async function*(){let e=r.getReader();try{for(;;){let{done:n,value:i}=await e.read();if(n)return;yield i}}finally{e.releaseLock()}}}});var on=D(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});var er=class{api;constructor(t){this.api=t}getInfo(){return this.api.get("info").then(t=>t.data)}getPeers(){return this.api.get("peers").then(t=>t.data)}};rr.default=er});var Qt=D(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.getError=void 0;var nr=class extends Error{type;response;constructor(t,e={}){e.message?super(e.message):super(),this.type=t,this.response=e.response}getType(){return this.type}};Zt.default=nr;function Ni(r){let t=r.data;if(typeof r.data=="string")try{t=JSON.parse(r.data)}catch{}if(r.data instanceof ArrayBuffer||r.data instanceof Uint8Array)try{t=JSON.parse(t.toString())}catch{}return t?t.error||t:r.statusText||"unknown"}Zt.getError=Ni});var fn=D(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});var ot=te();async function un(r){if(Array.isArray(r)){let n=ot.default.utils.concatBuffers([ot.default.utils.stringToBuffer("list"),ot.default.utils.stringToBuffer(r.length.toString())]);return await cn(r,await ot.default.crypto.hash(n,"SHA-384"))}let t=ot.default.utils.concatBuffers([ot.default.utils.stringToBuffer("blob"),ot.default.utils.stringToBuffer(r.byteLength.toString())]),e=ot.default.utils.concatBuffers([await ot.default.crypto.hash(t,"SHA-384"),await ot.default.crypto.hash(r,"SHA-384")]);return await ot.default.crypto.hash(e,"SHA-384")}ir.default=un;async function cn(r,t){if(r.length<1)return t;let e=ot.default.utils.concatBuffers([t,await un(r[0])]),n=await ot.default.crypto.hash(e,"SHA-384");return await cn(r.slice(1),n)}});var fr=D(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.debug=R.validatePath=R.arrayCompare=R.bufferToInt=R.intToBuffer=R.arrayFlatten=R.generateProofs=R.buildLayers=R.generateTransactionChunks=R.generateTree=R.computeRootHash=R.generateLeaves=R.chunkData=R.MIN_CHUNK_SIZE=R.MAX_CHUNK_SIZE=void 0;var Ee=te(),hn=pt();R.MAX_CHUNK_SIZE=256*1024;R.MIN_CHUNK_SIZE=32*1024;var re=32,$t=32;async function ar(r){let t=[],e=r,n=0;for(;e.byteLength>=R.MAX_CHUNK_SIZE;){let i=R.MAX_CHUNK_SIZE,a=e.byteLength-R.MAX_CHUNK_SIZE;a>0&&a<R.MIN_CHUNK_SIZE&&(i=Math.ceil(e.byteLength/2));let u=e.slice(0,i),y=await Ee.default.crypto.hash(u);n+=u.byteLength,t.push({dataHash:y,minByteRange:n-u.byteLength,maxByteRange:n}),e=e.slice(i)}return t.push({dataHash:await Ee.default.crypto.hash(e),minByteRange:n,maxByteRange:n+e.byteLength}),t}R.chunkData=ar;async function or(r){return Promise.all(r.map(async({dataHash:t,minByteRange:e,maxByteRange:n})=>({type:"leaf",id:await Y(await Promise.all([Y(t),Y(ne(n))])),dataHash:t,minByteRange:e,maxByteRange:n})))}R.generateLeaves=or;async function Ri(r){return(await ln(r)).id}R.computeRootHash=Ri;async function ln(r){return await Be(await or(await ar(r)))}R.generateTree=ln;async function Oi(r){let t=await ar(r),e=await or(t),n=await Be(e),i=await pn(n),a=t.slice(-1)[0];return a.maxByteRange-a.minByteRange===0&&(t.splice(t.length-1,1),i.splice(i.length-1,1)),{data_root:n.id,chunks:t,proofs:i}}R.generateTransactionChunks=Oi;async function Be(r,t=0){if(r.length<2)return r[0];let e=[];for(let n=0;n<r.length;n+=2)e.push(await ki(r[n],r[n+1]));return Be(e,t+1)}R.buildLayers=Be;function pn(r){let t=sr(r);return Array.isArray(t)?ur(t):[t]}R.generateProofs=pn;function sr(r,t=new Uint8Array,e=0){if(r.type=="leaf")return{offset:r.maxByteRange-1,proof:(0,hn.concatBuffers)([t,r.dataHash,ne(r.maxByteRange)])};if(r.type=="branch"){let n=(0,hn.concatBuffers)([t,r.leftChild.id,r.rightChild.id,ne(r.byteRange)]);return[sr(r.leftChild,n,e+1),sr(r.rightChild,n,e+1)]}throw new Error("Unexpected node type")}function ur(r){let t=[];return r.forEach(e=>{Array.isArray(e)?t.push(...ur(e)):t.push(e)}),t}R.arrayFlatten=ur;async function ki(r,t){return t?{type:"branch",id:await Y([await Y(r.id),await Y(t.id),await Y(ne(r.maxByteRange))]),byteRange:r.maxByteRange,maxByteRange:t.maxByteRange,leftChild:r,rightChild:t}:r}async function Y(r){return Array.isArray(r)&&(r=Ee.default.utils.concatBuffers(r)),new Uint8Array(await Ee.default.crypto.hash(r))}function ne(r){let t=new Uint8Array(re);for(var e=t.length-1;e>=0;e--){var n=r%256;t[e]=n,r=(r-n)/256}return t}R.intToBuffer=ne;function cr(r){let t=0;for(var e=0;e<r.length;e++)t*=256,t+=r[e];return t}R.bufferToInt=cr;var Ci=(r,t)=>r.every((e,n)=>t[n]===e);R.arrayCompare=Ci;async function ee(r,t,e,n,i){if(n<=0)return!1;if(t>=n)return ee(r,0,n-1,n,i);if(t<0)return ee(r,0,0,n,i);if(i.length==$t+re){let _=i.slice(0,$t),C=i.slice(_.length,_.length+re),F=await Y([await Y(_),await Y(C)]);return(0,R.arrayCompare)(r,F)?{offset:n-1,leftBound:e,rightBound:n,chunkSize:n-e}:!1}let a=i.slice(0,$t),u=i.slice(a.length,a.length+$t),y=i.slice(a.length+u.length,a.length+u.length+re),E=cr(y),b=i.slice(a.length+u.length+y.length),I=await Y([await Y(a),await Y(u),await Y(y)]);return(0,R.arrayCompare)(r,I)?t<E?await ee(a,t,e,Math.min(n,E),b):await ee(u,t,Math.max(e,E),n,b):!1}R.validatePath=ee;async function gn(r,t=""){if(r.byteLength<1)return t;let e=r.slice(0,$t),n=r.slice(e.length,e.length+$t),i=r.slice(e.length+n.length,e.length+n.length+re),a=cr(i),u=r.slice(e.length+n.length+i.length),y=await Y([await Y(e),await Y(n),await Y(i)]),E=`${t}
${JSON.stringify(Buffer.from(e))},${JSON.stringify(Buffer.from(n))},${a} => ${JSON.stringify(y)}`;return gn(u,E)}R.debug=gn});var Ae=D(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.Tag=void 0;var J=pt(),Fi=fn(),Pi=fr(),Te=class{get(t,e){if(!Object.getOwnPropertyNames(this).includes(t))throw new Error(`Field "${t}" is not a property of the Arweave Transaction class.`);if(this[t]instanceof Uint8Array)return e&&e.decode&&e.string?J.bufferToString(this[t]):e&&e.decode&&!e.string?this[t]:J.bufferTob64Url(this[t]);if(this[t]instanceof Array){if(e?.decode!==void 0||e?.string!==void 0)throw t==="tags"&&console.warn(`Did you mean to use 'transaction["tags"]' ?`),new Error("Cannot decode or stringify an array.");return this[t]}return e&&e.decode==!0?e&&e.string?J.b64UrlToString(this[t]):J.b64UrlToBuffer(this[t]):this[t]}},ie=class extends Te{name;value;constructor(t,e,n=!1){super(),this.name=t,this.value=e}};se.Tag=ie;var hr=class extends Te{format=2;id="";last_tx="";owner="";tags=[];target="";quantity="0";data_size="0";data=new Uint8Array;data_root="";reward="0";signature="";chunks;constructor(t={}){super(),Object.assign(this,t),typeof this.data=="string"&&(this.data=J.b64UrlToBuffer(this.data)),t.tags&&(this.tags=t.tags.map(e=>new ie(e.name,e.value)))}addTag(t,e){this.tags.push(new ie(J.stringToB64Url(t),J.stringToB64Url(e)))}toJSON(){return{format:this.format,id:this.id,last_tx:this.last_tx,owner:this.owner,tags:this.tags,target:this.target,quantity:this.quantity,data:J.bufferTob64Url(this.data),data_size:this.data_size,data_root:this.data_root,data_tree:this.data_tree,reward:this.reward,signature:this.signature}}setOwner(t){this.owner=t}setSignature({id:t,owner:e,reward:n,tags:i,signature:a}){this.id=t,this.owner=e,n&&(this.reward=n),i&&(this.tags=i),this.signature=a}async prepareChunks(t){!this.chunks&&t.byteLength>0&&(this.chunks=await(0,Pi.generateTransactionChunks)(t),this.data_root=J.bufferTob64Url(this.chunks.data_root)),!this.chunks&&t.byteLength===0&&(this.chunks={chunks:[],data_root:new Uint8Array,proofs:[]},this.data_root="")}getChunk(t,e){if(!this.chunks)throw new Error("Chunks have not been prepared");let n=this.chunks.proofs[t],i=this.chunks.chunks[t];return{data_root:this.data_root,data_size:this.data_size,data_path:J.bufferTob64Url(n.proof),offset:n.offset.toString(),chunk:J.bufferTob64Url(e.slice(i.minByteRange,i.maxByteRange))}}async getSignatureData(){switch(this.format){case 1:let t=this.tags.reduce((n,i)=>J.concatBuffers([n,i.get("name",{decode:!0,string:!1}),i.get("value",{decode:!0,string:!1})]),new Uint8Array);return J.concatBuffers([this.get("owner",{decode:!0,string:!1}),this.get("target",{decode:!0,string:!1}),this.get("data",{decode:!0,string:!1}),J.stringToBuffer(this.quantity),J.stringToBuffer(this.reward),this.get("last_tx",{decode:!0,string:!1}),t]);case 2:this.data_root||await this.prepareChunks(this.data);let e=this.tags.map(n=>[n.get("name",{decode:!0,string:!1}),n.get("value",{decode:!0,string:!1})]);return await(0,Fi.default)([J.stringToBuffer(this.format.toString()),this.get("owner",{decode:!0,string:!1}),this.get("target",{decode:!0,string:!1}),J.stringToBuffer(this.quantity),J.stringToBuffer(this.reward),this.get("last_tx",{decode:!0,string:!1}),e,J.stringToBuffer(this.data_size),this.get("data_root",{decode:!0,string:!1})]);default:throw new Error(`Unexpected transaction format: ${this.format}`)}}};se.default=hr});var mn=D(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.TransactionUploader=void 0;var dn=Ae(),Di=pt(),lr=Qt(),vi=fr(),wn=1,Mi=["invalid_json","chunk_too_big","data_path_too_big","offset_too_big","data_size_too_big","chunk_proof_ratio_not_attractive","invalid_proof"],yn=1e3*40,ae=class{api;chunkIndex=0;txPosted=!1;transaction;lastRequestTimeEnd=0;totalErrors=0;data;lastResponseStatus=0;lastResponseError="";get isComplete(){return this.txPosted&&this.chunkIndex===this.transaction.chunks.chunks.length}get totalChunks(){return this.transaction.chunks.chunks.length}get uploadedChunks(){return this.chunkIndex}get pctComplete(){return Math.trunc(this.uploadedChunks/this.totalChunks*100)}constructor(t,e){if(this.api=t,!e.id)throw new Error("Transaction is not signed");if(!e.chunks)throw new Error("Transaction chunks not prepared");this.data=e.data,this.transaction=new dn.default(Object.assign({},e,{data:new Uint8Array(0)}))}async uploadChunk(t){if(this.isComplete)throw new Error("Upload is already complete");if(this.lastResponseError!==""?this.totalErrors++:this.totalErrors=0,this.totalErrors===100)throw new Error(`Unable to complete upload: ${this.lastResponseStatus}: ${this.lastResponseError}`);let e=this.lastResponseError===""?0:Math.max(this.lastRequestTimeEnd+yn-Date.now(),yn);if(e>0&&(e=e-e*Math.random()*.3,await new Promise(u=>setTimeout(u,e))),this.lastResponseError="",!this.txPosted){await this.postTransaction();return}t&&(this.chunkIndex=t);let n=this.transaction.getChunk(t||this.chunkIndex,this.data);if(!await(0,vi.validatePath)(this.transaction.chunks.data_root,parseInt(n.offset),0,parseInt(n.data_size),Di.b64UrlToBuffer(n.data_path)))throw new Error(`Unable to validate chunk ${this.chunkIndex}`);let a=await this.api.post("chunk",this.transaction.getChunk(this.chunkIndex,this.data)).catch(u=>(console.error(u.message),{status:-1,data:{error:u.message}}));if(this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=a.status,this.lastResponseStatus==200)this.chunkIndex++;else if(this.lastResponseError=(0,lr.getError)(a),Mi.includes(this.lastResponseError))throw new Error(`Fatal error uploading chunk ${this.chunkIndex}: ${this.lastResponseError}`)}static async fromSerialized(t,e,n){if(!e||typeof e.chunkIndex!="number"||typeof e.transaction!="object")throw new Error("Serialized object does not match expected format.");var i=new dn.default(e.transaction);i.chunks||await i.prepareChunks(n);let a=new ae(t,i);if(a.chunkIndex=e.chunkIndex,a.lastRequestTimeEnd=e.lastRequestTimeEnd,a.lastResponseError=e.lastResponseError,a.lastResponseStatus=e.lastResponseStatus,a.txPosted=e.txPosted,a.data=n,a.transaction.data_root!==e.transaction.data_root)throw new Error("Data mismatch: Uploader doesn't match provided data.");return a}static async fromTransactionId(t,e){let n=await t.get(`tx/${e}`);if(n.status!==200)throw new Error(`Tx ${e} not found: ${n.status}`);let i=n.data;return i.data=new Uint8Array(0),{txPosted:!0,chunkIndex:0,lastResponseError:"",lastRequestTimeEnd:0,lastResponseStatus:0,transaction:i}}toJSON(){return{chunkIndex:this.chunkIndex,transaction:this.transaction,lastRequestTimeEnd:this.lastRequestTimeEnd,lastResponseStatus:this.lastResponseStatus,lastResponseError:this.lastResponseError,txPosted:this.txPosted}}async postTransaction(){if(this.totalChunks<=wn){this.transaction.data=this.data;let n=await this.api.post("tx",this.transaction).catch(i=>(console.error(i),{status:-1,data:{error:i.message}}));if(this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=n.status,this.transaction.data=new Uint8Array(0),n.status>=200&&n.status<300){this.txPosted=!0,this.chunkIndex=wn;return}throw this.lastResponseError=(0,lr.getError)(n),new Error(`Unable to upload transaction: ${n.status}, ${this.lastResponseError}`)}let e=await this.api.post("tx",this.transaction);if(this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=e.status,!(e.status>=200&&e.status<300))throw this.lastResponseError=(0,lr.getError)(e),new Error(`Unable to upload transaction: ${e.status}, ${this.lastResponseError}`);this.txPosted=!0}};_e.TransactionUploader=ae});var be=D((na,xn)=>{xn.exports={}});var En=D(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});var pr=Qt(),At=Ae(),oe=pt(),gr=mn();be();var dr=class{api;crypto;chunks;constructor(t,e,n){this.api=t,this.crypto=e,this.chunks=n}async getTransactionAnchor(){let t=await this.api.get("tx_anchor");if(!t.data.match(/^[a-z0-9_-]{43,}/i)||!t.ok)throw new Error(`Could not getTransactionAnchor. Received: ${t.data}. Status: ${t.status}, ${t.statusText}`);return t.data}async getPrice(t,e){let n=e?`price/${t}/${e}`:`price/${t}`,i=await this.api.get(n);if(!/^\d+$/.test(i.data)||!i.ok)throw new Error(`Could not getPrice. Received: ${i.data}. Status: ${i.status}, ${i.statusText}`);return i.data}async get(t){let e=await this.api.get(`tx/${t}`);if(e.status==200){let n=parseInt(e.data.data_size);if(e.data.format>=2&&n>0&&n<=1024*1024*12){let i=await this.getData(t);return new At.default({...e.data,data:i})}return new At.default({...e.data,format:e.data.format||1})}throw e.status==404?new pr.default("TX_NOT_FOUND"):e.status==410?new pr.default("TX_FAILED"):new pr.default("TX_INVALID")}fromRaw(t){return new At.default(t)}async search(t,e){return this.api.post("arql",{op:"equals",expr1:t,expr2:e}).then(n=>n.data?n.data:[])}getStatus(t){return this.api.get(`tx/${t}/status`).then(e=>e.status==200?{status:200,confirmed:e.data}:{status:e.status,confirmed:null})}async getData(t,e){let n;try{n=await this.chunks.downloadChunkedData(t)}catch(i){console.error(`Error while trying to download chunked data for ${t}`),console.error(i)}if(!n){console.warn(`Falling back to gateway cache for ${t}`);try{let{data:i,ok:a,status:u,statusText:y}=await this.api.get(`/${t}`,{responseType:"arraybuffer"});if(!a)throw new Error("Bad http status code",{cause:{status:u,statusText:y}});n=i}catch(i){console.error(`Error while trying to download contiguous data from gateway cache for ${t}`),console.error(i)}}if(!n)throw new Error(`${t} data was not found!`);return e&&e.decode&&!e.string?n:e&&e.decode&&e.string?oe.bufferToString(n):oe.bufferTob64Url(n)}async sign(t,e,n){let a=typeof e=="object"&&(y=>{let E=!0;return["n","e","d","p","q","dp","dq","qi"].map(b=>!(b in y)&&(E=!1)),E})(e),u=typeof arweaveWallet=="object";if(!a&&!u)throw new Error("No valid JWK or external wallet found to sign transaction.");if(u){try{(await arweaveWallet.getPermissions()).includes("SIGN_TRANSACTION")||await arweaveWallet.connect(["SIGN_TRANSACTION"])}catch{}let y=await arweaveWallet.sign(t,n);t.setSignature({id:y.id,owner:y.owner,reward:y.reward,tags:y.tags,signature:y.signature})}else if(a){t.setOwner(e.n);let y=await t.getSignatureData(),E=await this.crypto.sign(e,y,n),b=await this.crypto.hash(E);t.setSignature({id:oe.bufferTob64Url(b),owner:e.n,signature:oe.bufferTob64Url(E)})}else throw new Error("An error occurred while signing. Check wallet is valid")}async verify(t){let e=await t.getSignatureData(),n=t.get("signature",{decode:!0,string:!1}),i=oe.bufferTob64Url(await this.crypto.hash(n));if(t.id!==i)throw new Error("Invalid transaction signature or ID! The transaction ID doesn't match the expected SHA-256 hash of the signature.");return this.crypto.verify(t.owner,e,n)}async post(t){if(typeof t=="string"?t=new At.default(JSON.parse(t)):typeof t.readInt32BE=="function"?t=new At.default(JSON.parse(t.toString())):typeof t=="object"&&!(t instanceof At.default)&&(t=new At.default(t)),!(t instanceof At.default))throw new Error("Must be Transaction object");t.chunks||await t.prepareChunks(t.data);let e=await this.getUploader(t,t.data);try{for(;!e.isComplete;)await e.uploadChunk()}catch(n){if(e.lastResponseStatus>0)return{status:e.lastResponseStatus,statusText:e.lastResponseError,data:{error:e.lastResponseError}};throw n}return{status:200,statusText:"OK",data:{}}}async getUploader(t,e){let n;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),t instanceof At.default){if(e||(e=t.data),!(e instanceof Uint8Array))throw new Error("Data format is invalid");t.chunks||await t.prepareChunks(e),n=new gr.TransactionUploader(this.api,t),(!n.data||n.data.length===0)&&(n.data=e)}else{if(typeof t=="string"&&(t=await gr.TransactionUploader.fromTransactionId(this.api,t)),!e||!(e instanceof Uint8Array))throw new Error("Must provide data when resuming upload");n=await gr.TransactionUploader.fromSerialized(this.api,t,e)}return n}async*upload(t,e){let n=await this.getUploader(t,e);for(;!n.isComplete;)await n.uploadChunk(),yield n;return n}};wr.default=dr});var Tn=D(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});var Bn=pt();be();var yr=class{api;crypto;constructor(t,e){this.api=t,this.crypto=e}getBalance(t){return this.api.get(`wallet/${t}/balance`).then(e=>e.data)}getLastTransactionID(t){return this.api.get(`wallet/${t}/last_tx`).then(e=>e.data)}generate(){return this.crypto.generateJWK()}async jwkToAddress(t){return!t||t==="use_wallet"?this.getAddress():this.getAddress(t)}async getAddress(t){if(!t||t==="use_wallet"){try{await arweaveWallet.connect(["ACCESS_ADDRESS"])}catch{}return arweaveWallet.getActiveAddress()}else return this.ownerToAddress(t.n)}async ownerToAddress(t){return Bn.bufferTob64Url(await this.crypto.hash(Bn.b64UrlToBuffer(t)))}};mr.default=yr});var _n=D(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.SiloResource=void 0;var An=pt(),xr=class{api;crypto;transactions;constructor(t,e,n){this.api=t,this.crypto=e,this.transactions=n}async get(t){if(!t)throw new Error("No Silo URI specified");let e=await this.parseUri(t),n=await this.transactions.search("Silo-Name",e.getAccessKey());if(n.length==0)throw new Error(`No data could be found for the Silo URI: ${t}`);let i=await this.transactions.get(n[0]);if(!i)throw new Error(`No data could be found for the Silo URI: ${t}`);let a=i.get("data",{decode:!0,string:!1});return this.crypto.decrypt(a,e.getEncryptionKey())}async readTransactionData(t,e){if(!e)throw new Error("No Silo URI specified");let n=await this.parseUri(e),i=t.get("data",{decode:!0,string:!1});return this.crypto.decrypt(i,n.getEncryptionKey())}async parseUri(t){let e=t.match(/^([a-z0-9-_]+)\.([0-9]+)/i);if(!e)throw new Error("Invalid Silo name, must be a name in the format of [a-z0-9]+.[0-9]+, e.g. 'bubble.7'");let n=e[1],i=Math.pow(2,parseInt(e[2])),a=await this.hash(An.stringToBuffer(n),i),u=An.bufferTob64(a.slice(0,15)),y=await this.hash(a.slice(16,31),1);return new Se(t,u,y)}async hash(t,e){let n=await this.crypto.hash(t);for(let i=0;i<e-1;i++)n=await this.crypto.hash(n);return n}};ue.default=xr;var Se=class{uri;accessKey;encryptionKey;constructor(t,e,n){this.uri=t,this.accessKey=e,this.encryptionKey=n}getUri(){return this.uri}getAccessKey(){return this.accessKey}getEncryptionKey(){return this.encryptionKey}};ue.SiloResource=Se});var Sn=D(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});var bn=Qt(),$i=pt(),Er=class{api;constructor(t){this.api=t}async getTransactionOffset(t){let e=await this.api.get(`tx/${t}/offset`);if(e.status===200)return e.data;throw new Error(`Unable to get transaction offset: ${(0,bn.getError)(e)}`)}async getChunk(t){let e=await this.api.get(`chunk/${t}`);if(e.status===200)return e.data;throw new Error(`Unable to get chunk: ${(0,bn.getError)(e)}`)}async getChunkData(t){let e=await this.getChunk(t);return $i.b64UrlToBuffer(e.chunk)}firstChunkOffset(t){return parseInt(t.offset)-parseInt(t.size)+1}async downloadChunkedData(t){let e=await this.getTransactionOffset(t),n=parseInt(e.size),a=parseInt(e.offset)-n+1,u=new Uint8Array(n),y=0;for(;y<n;){this.api.config.logging&&console.log(`[chunk] ${y}/${n}`);let E;try{E=await this.getChunkData(a+y)}catch{console.error(`[chunk] Failed to fetch chunk at offset ${a+y}`),console.error("[chunk] This could indicate that the chunk wasn't uploaded or hasn't yet seeded properly to a particular gateway/node")}if(E)u.set(E,y),y+=E.length;else throw new Error(`Couldn't complete data download at ${y}/${n}`)}return u}};Br.default=Er});var In=D(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});var qi=Qt();be();var Ar=class{api;network;constructor(t,e){this.api=t,this.network=e}async get(t){let e=await this.api.get(`${Ar.ENDPOINT}${t}`);if(e.status===200)return e.data;throw e.status===404?new qi.default("BLOCK_NOT_FOUND"):new Error(`Error while loading block data: ${e}`)}async getCurrent(){let{current:t}=await this.network.getInfo();return await this.get(t)}},Ie=Ar;vt(Ie,"ENDPOINT","block/hash/");Tr.default=Ie});var te=D(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});var Hi=sn(),Ki=an(),ji=Xe(),Gi=on(),zi=En(),Wi=Tn(),Un=Ae(),ce=pt(),Xi=_n(),Ji=Sn(),Vi=In(),Ht=class{api;wallets;transactions;network;blocks;ar;silo;chunks;constructor(t){this.api=new Ki.default(t),this.wallets=new Wi.default(this.api,Ht.crypto),this.chunks=new Ji.default(this.api),this.transactions=new zi.default(this.api,Ht.crypto,this.chunks),this.silo=new Xi.default(this.api,this.crypto,this.transactions),this.network=new Gi.default(this.api),this.blocks=new Vi.default(this.api,this.network),this.ar=new Hi.default}get crypto(){return Ht.crypto}get utils(){return Ht.utils}getConfig(){return{api:this.api.getConfig(),crypto:null}}async createTransaction(t,e){let n={};if(Object.assign(n,t),!t.data&&!(t.target&&t.quantity))throw new Error("A new Arweave transaction must have a 'data' value, or 'target' and 'quantity' values.");if(t.owner==null&&e&&e!=="use_wallet"&&(n.owner=e.n),t.last_tx==null&&(n.last_tx=await this.transactions.getTransactionAnchor()),typeof t.data=="string"&&(t.data=ce.stringToBuffer(t.data)),t.data instanceof ArrayBuffer&&(t.data=new Uint8Array(t.data)),t.data&&!(t.data instanceof Uint8Array))throw new Error("Expected data to be a string, Uint8Array or ArrayBuffer");if(t.reward==null){let a=t.data?t.data.byteLength:0;n.reward=await this.transactions.getPrice(a,n.target)}n.data_root="",n.data_size=t.data?t.data.byteLength.toString():"0",n.data=t.data||new Uint8Array(0);let i=new Un.default(n);return await i.getSignatureData(),i}async createSiloTransaction(t,e,n){let i={};if(Object.assign(i,t),!t.data)throw new Error("Silo transactions must have a 'data' value");if(!n)throw new Error("No Silo URI specified.");if(t.target||t.quantity)throw new Error("Silo transactions can only be used for storing data, sending AR to other wallets isn't supported.");if(t.owner==null){if(!e||!e.n)throw new Error("A new Arweave transaction must either have an 'owner' attribute, or you must provide the jwk parameter.");i.owner=e.n}t.last_tx==null&&(i.last_tx=await this.transactions.getTransactionAnchor());let a=await this.silo.parseUri(n);if(typeof t.data=="string"){let y=await this.crypto.encrypt(ce.stringToBuffer(t.data),a.getEncryptionKey());i.reward=await this.transactions.getPrice(y.byteLength),i.data=ce.bufferTob64Url(y)}if(t.data instanceof Uint8Array){let y=await this.crypto.encrypt(t.data,a.getEncryptionKey());i.reward=await this.transactions.getPrice(y.byteLength),i.data=ce.bufferTob64Url(y)}let u=new Un.default(i);return u.addTag("Silo-Name",a.getAccessKey()),u.addTag("Silo-Version","0.1.0"),u}arql(t){return this.api.post("/arql",t).then(e=>e.data||[])}},qt=Ht;vt(qt,"init"),vt(qt,"crypto",new ji.default),vt(qt,"utils",ce);_r.default=qt});var Ln=D(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.getDefaultConfig=void 0;var Yi=(r,t)=>{let e=/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,n=t.split("."),i=n[n.length-1],a=["localhost","[::1]"];return a.includes(t)||r=="file"||a.includes(i)||!!t.match(e)||!!i.match(e)},Zi=r=>{let t=r.charAt(0)==="[",e=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/;return!!r.match(e)||t},Qi=(r,t)=>{if(Yi(r,t))return{protocol:"https",host:"arweave.net",port:443};if(!Zi(t)){let e=t.split(".");if(e.length>=3){e.shift();let n=e.join(".");return{protocol:r,host:n}}}return{protocol:r,host:t}};Ue.getDefaultConfig=Qi});var Nn=D(Ut=>{"use strict";var ts=Ut&&Ut.__createBinding||(Object.create?function(r,t,e,n){n===void 0&&(n=e);var i=Object.getOwnPropertyDescriptor(t,e);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(r,n,i)}:function(r,t,e,n){n===void 0&&(n=e),r[n]=t[e]}),es=Ut&&Ut.__exportStar||function(r,t){for(var e in r)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&ts(t,r,e)};Object.defineProperty(Ut,"__esModule",{value:!0});var Kt=te(),rs=Ln();Kt.default.init=function(r={}){let t={host:"arweave.net",port:443,protocol:"https"};if(typeof location!="object"||!location.protocol||!location.hostname)return new Kt.default({...r,...t});let e=location.protocol.replace(":",""),n=location.hostname,i=location.port?parseInt(location.port):e=="https"?443:80,a=(0,rs.getDefaultConfig)(e,n),u=r.protocol||a.protocol,y=r.host||a.host,E=r.port||a.port||i;return new Kt.default({...r,host:y,protocol:u,port:E})};typeof globalThis=="object"?globalThis.Arweave=Kt.default:typeof self=="object"&&(self.Arweave=Kt.default);es(te(),Ut);Ut.default=Kt.default});var kn=D(Ir=>{Ir.read=function(r,t,e,n,i){var a,u,y=i*8-n-1,E=(1<<y)-1,b=E>>1,I=-7,_=e?i-1:0,C=e?-1:1,F=r[t+_];for(_+=C,a=F&(1<<-I)-1,F>>=-I,I+=y;I>0;a=a*256+r[t+_],_+=C,I-=8);for(u=a&(1<<-I)-1,a>>=-I,I+=n;I>0;u=u*256+r[t+_],_+=C,I-=8);if(a===0)a=1-b;else{if(a===E)return u?NaN:(F?-1:1)*(1/0);u=u+Math.pow(2,n),a=a-b}return(F?-1:1)*u*Math.pow(2,a-n)};Ir.write=function(r,t,e,n,i,a){var u,y,E,b=a*8-i-1,I=(1<<b)-1,_=I>>1,C=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=n?0:a-1,G=n?1:-1,V=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(y=isNaN(t)?1:0,u=I):(u=Math.floor(Math.log(t)/Math.LN2),t*(E=Math.pow(2,-u))<1&&(u--,E*=2),u+_>=1?t+=C/E:t+=C*Math.pow(2,1-_),t*E>=2&&(u++,E/=2),u+_>=I?(y=0,u=I):u+_>=1?(y=(t*E-1)*Math.pow(2,i),u=u+_):(y=t*Math.pow(2,_-1)*Math.pow(2,i),u=0));i>=8;r[e+F]=y&255,F+=G,y/=256,i-=8);for(u=u<<i|y,b+=i;b>0;r[e+F]=u&255,F+=G,u/=256,b-=8);r[e+F-G]|=V*128}});var Pr=D(Xt=>{"use strict";var Ur=Ge(),zt=kn(),Cn=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Xt.Buffer=x;Xt.SlowBuffer=fs;Xt.INSPECT_MAX_BYTES=50;var Re=2147483647;Xt.kMaxLength=Re;x.TYPED_ARRAY_SUPPORT=ss();!x.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function ss(){try{let r=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(r,t),r.foo()===42}catch{return!1}}Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.buffer}});Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.byteOffset}});function bt(r){if(r>Re)throw new RangeError('The value "'+r+'" is invalid for option "size"');let t=new Uint8Array(r);return Object.setPrototypeOf(t,x.prototype),t}function x(r,t,e){if(typeof r=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Or(r)}return vn(r,t,e)}x.poolSize=8192;function vn(r,t,e){if(typeof r=="string")return os(r,t);if(ArrayBuffer.isView(r))return us(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(yt(r,ArrayBuffer)||r&&yt(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(yt(r,SharedArrayBuffer)||r&&yt(r.buffer,SharedArrayBuffer)))return Nr(r,t,e);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return x.from(n,t,e);let i=cs(r);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return x.from(r[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}x.from=function(r,t,e){return vn(r,t,e)};Object.setPrototypeOf(x.prototype,Uint8Array.prototype);Object.setPrototypeOf(x,Uint8Array);function Mn(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function as(r,t,e){return Mn(r),r<=0?bt(r):t!==void 0?typeof e=="string"?bt(r).fill(t,e):bt(r).fill(t):bt(r)}x.alloc=function(r,t,e){return as(r,t,e)};function Or(r){return Mn(r),bt(r<0?0:kr(r)|0)}x.allocUnsafe=function(r){return Or(r)};x.allocUnsafeSlow=function(r){return Or(r)};function os(r,t){if((typeof t!="string"||t==="")&&(t="utf8"),!x.isEncoding(t))throw new TypeError("Unknown encoding: "+t);let e=$n(r,t)|0,n=bt(e),i=n.write(r,t);return i!==e&&(n=n.slice(0,i)),n}function Lr(r){let t=r.length<0?0:kr(r.length)|0,e=bt(t);for(let n=0;n<t;n+=1)e[n]=r[n]&255;return e}function us(r){if(yt(r,Uint8Array)){let t=new Uint8Array(r);return Nr(t.buffer,t.byteOffset,t.byteLength)}return Lr(r)}function Nr(r,t,e){if(t<0||r.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');let n;return t===void 0&&e===void 0?n=new Uint8Array(r):e===void 0?n=new Uint8Array(r,t):n=new Uint8Array(r,t,e),Object.setPrototypeOf(n,x.prototype),n}function cs(r){if(x.isBuffer(r)){let t=kr(r.length)|0,e=bt(t);return e.length===0||r.copy(e,0,0,t),e}if(r.length!==void 0)return typeof r.length!="number"||Fr(r.length)?bt(0):Lr(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Lr(r.data)}function kr(r){if(r>=Re)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Re.toString(16)+" bytes");return r|0}function fs(r){return+r!=r&&(r=0),x.alloc(+r)}x.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==x.prototype};x.compare=function(t,e){if(yt(t,Uint8Array)&&(t=x.from(t,t.offset,t.byteLength)),yt(e,Uint8Array)&&(e=x.from(e,e.offset,e.byteLength)),!x.isBuffer(t)||!x.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,i=e.length;for(let a=0,u=Math.min(n,i);a<u;++a)if(t[a]!==e[a]){n=t[a],i=e[a];break}return n<i?-1:i<n?1:0};x.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};x.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return x.alloc(0);let n;if(e===void 0)for(e=0,n=0;n<t.length;++n)e+=t[n].length;let i=x.allocUnsafe(e),a=0;for(n=0;n<t.length;++n){let u=t[n];if(yt(u,Uint8Array))a+u.length>i.length?(x.isBuffer(u)||(u=x.from(u)),u.copy(i,a)):Uint8Array.prototype.set.call(i,u,a);else if(x.isBuffer(u))u.copy(i,a);else throw new TypeError('"list" argument must be an Array of Buffers');a+=u.length}return i};function $n(r,t){if(x.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||yt(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let e=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&e===0)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return Rr(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return Jn(r).length;default:if(i)return n?-1:Rr(r).length;t=(""+t).toLowerCase(),i=!0}}x.byteLength=$n;function hs(r,t,e){let n=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(r||(r="utf8");;)switch(r){case"hex":return Bs(this,t,e);case"utf8":case"utf-8":return Hn(this,t,e);case"ascii":return xs(this,t,e);case"latin1":case"binary":return Es(this,t,e);case"base64":return ys(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ts(this,t,e);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}x.prototype._isBuffer=!0;function Ft(r,t,e){let n=r[t];r[t]=r[e],r[e]=n}x.prototype.swap16=function(){let t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)Ft(this,e,e+1);return this};x.prototype.swap32=function(){let t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)Ft(this,e,e+3),Ft(this,e+1,e+2);return this};x.prototype.swap64=function(){let t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)Ft(this,e,e+7),Ft(this,e+1,e+6),Ft(this,e+2,e+5),Ft(this,e+3,e+4);return this};x.prototype.toString=function(){let t=this.length;return t===0?"":arguments.length===0?Hn(this,0,t):hs.apply(this,arguments)};x.prototype.toLocaleString=x.prototype.toString;x.prototype.equals=function(t){if(!x.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:x.compare(this,t)===0};x.prototype.inspect=function(){let t="",e=Xt.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"};Cn&&(x.prototype[Cn]=x.prototype.inspect);x.prototype.compare=function(t,e,n,i,a){if(yt(t,Uint8Array)&&(t=x.from(t,t.offset,t.byteLength)),!x.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),n===void 0&&(n=t?t.length:0),i===void 0&&(i=0),a===void 0&&(a=this.length),e<0||n>t.length||i<0||a>this.length)throw new RangeError("out of range index");if(i>=a&&e>=n)return 0;if(i>=a)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,a>>>=0,this===t)return 0;let u=a-i,y=n-e,E=Math.min(u,y),b=this.slice(i,a),I=t.slice(e,n);for(let _=0;_<E;++_)if(b[_]!==I[_]){u=b[_],y=I[_];break}return u<y?-1:y<u?1:0};function qn(r,t,e,n,i){if(r.length===0)return-1;if(typeof e=="string"?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,Fr(e)&&(e=i?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(i)return-1;e=r.length-1}else if(e<0)if(i)e=0;else return-1;if(typeof t=="string"&&(t=x.from(t,n)),x.isBuffer(t))return t.length===0?-1:Fn(r,t,e,n,i);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):Fn(r,[t],e,n,i);throw new TypeError("val must be string, number or Buffer")}function Fn(r,t,e,n,i){let a=1,u=r.length,y=t.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||t.length<2)return-1;a=2,u/=2,y/=2,e/=2}function E(I,_){return a===1?I[_]:I.readUInt16BE(_*a)}let b;if(i){let I=-1;for(b=e;b<u;b++)if(E(r,b)===E(t,I===-1?0:b-I)){if(I===-1&&(I=b),b-I+1===y)return I*a}else I!==-1&&(b-=b-I),I=-1}else for(e+y>u&&(e=u-y),b=e;b>=0;b--){let I=!0;for(let _=0;_<y;_++)if(E(r,b+_)!==E(t,_)){I=!1;break}if(I)return b}return-1}x.prototype.includes=function(t,e,n){return this.indexOf(t,e,n)!==-1};x.prototype.indexOf=function(t,e,n){return qn(this,t,e,n,!0)};x.prototype.lastIndexOf=function(t,e,n){return qn(this,t,e,n,!1)};function ls(r,t,e,n){e=Number(e)||0;let i=r.length-e;n?(n=Number(n),n>i&&(n=i)):n=i;let a=t.length;n>a/2&&(n=a/2);let u;for(u=0;u<n;++u){let y=parseInt(t.substr(u*2,2),16);if(Fr(y))return u;r[e+u]=y}return u}function ps(r,t,e,n){return Oe(Rr(t,r.length-e),r,e,n)}function gs(r,t,e,n){return Oe(Ss(t),r,e,n)}function ds(r,t,e,n){return Oe(Jn(t),r,e,n)}function ws(r,t,e,n){return Oe(Is(t,r.length-e),r,e,n)}x.prototype.write=function(t,e,n,i){if(e===void 0)i="utf8",n=this.length,e=0;else if(n===void 0&&typeof e=="string")i=e,n=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let a=this.length-e;if((n===void 0||n>a)&&(n=a),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let u=!1;for(;;)switch(i){case"hex":return ls(this,t,e,n);case"utf8":case"utf-8":return ps(this,t,e,n);case"ascii":case"latin1":case"binary":return gs(this,t,e,n);case"base64":return ds(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ws(this,t,e,n);default:if(u)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),u=!0}};x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ys(r,t,e){return t===0&&e===r.length?Ur.fromByteArray(r):Ur.fromByteArray(r.slice(t,e))}function Hn(r,t,e){e=Math.min(r.length,e);let n=[],i=t;for(;i<e;){let a=r[i],u=null,y=a>239?4:a>223?3:a>191?2:1;if(i+y<=e){let E,b,I,_;switch(y){case 1:a<128&&(u=a);break;case 2:E=r[i+1],(E&192)===128&&(_=(a&31)<<6|E&63,_>127&&(u=_));break;case 3:E=r[i+1],b=r[i+2],(E&192)===128&&(b&192)===128&&(_=(a&15)<<12|(E&63)<<6|b&63,_>2047&&(_<55296||_>57343)&&(u=_));break;case 4:E=r[i+1],b=r[i+2],I=r[i+3],(E&192)===128&&(b&192)===128&&(I&192)===128&&(_=(a&15)<<18|(E&63)<<12|(b&63)<<6|I&63,_>65535&&_<1114112&&(u=_))}}u===null?(u=65533,y=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|u&1023),n.push(u),i+=y}return ms(n)}var Pn=4096;function ms(r){let t=r.length;if(t<=Pn)return String.fromCharCode.apply(String,r);let e="",n=0;for(;n<t;)e+=String.fromCharCode.apply(String,r.slice(n,n+=Pn));return e}function xs(r,t,e){let n="";e=Math.min(r.length,e);for(let i=t;i<e;++i)n+=String.fromCharCode(r[i]&127);return n}function Es(r,t,e){let n="";e=Math.min(r.length,e);for(let i=t;i<e;++i)n+=String.fromCharCode(r[i]);return n}function Bs(r,t,e){let n=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>n)&&(e=n);let i="";for(let a=t;a<e;++a)i+=Us[r[a]];return i}function Ts(r,t,e){let n=r.slice(t,e),i="";for(let a=0;a<n.length-1;a+=2)i+=String.fromCharCode(n[a]+n[a+1]*256);return i}x.prototype.slice=function(t,e){let n=this.length;t=~~t,e=e===void 0?n:~~e,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),e<t&&(e=t);let i=this.subarray(t,e);return Object.setPrototypeOf(i,x.prototype),i};function Z(r,t,e){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}x.prototype.readUintLE=x.prototype.readUIntLE=function(t,e,n){t=t>>>0,e=e>>>0,n||Z(t,e,this.length);let i=this[t],a=1,u=0;for(;++u<e&&(a*=256);)i+=this[t+u]*a;return i};x.prototype.readUintBE=x.prototype.readUIntBE=function(t,e,n){t=t>>>0,e=e>>>0,n||Z(t,e,this.length);let i=this[t+--e],a=1;for(;e>0&&(a*=256);)i+=this[t+--e]*a;return i};x.prototype.readUint8=x.prototype.readUInt8=function(t,e){return t=t>>>0,e||Z(t,1,this.length),this[t]};x.prototype.readUint16LE=x.prototype.readUInt16LE=function(t,e){return t=t>>>0,e||Z(t,2,this.length),this[t]|this[t+1]<<8};x.prototype.readUint16BE=x.prototype.readUInt16BE=function(t,e){return t=t>>>0,e||Z(t,2,this.length),this[t]<<8|this[t+1]};x.prototype.readUint32LE=x.prototype.readUInt32LE=function(t,e){return t=t>>>0,e||Z(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};x.prototype.readUint32BE=x.prototype.readUInt32BE=function(t,e){return t=t>>>0,e||Z(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};x.prototype.readBigUInt64LE=Lt(function(t){t=t>>>0,Wt(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&he(t,this.length-8);let i=e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,a=this[++t]+this[++t]*2**8+this[++t]*2**16+n*2**24;return BigInt(i)+(BigInt(a)<<BigInt(32))});x.prototype.readBigUInt64BE=Lt(function(t){t=t>>>0,Wt(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&he(t,this.length-8);let i=e*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],a=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(a)});x.prototype.readIntLE=function(t,e,n){t=t>>>0,e=e>>>0,n||Z(t,e,this.length);let i=this[t],a=1,u=0;for(;++u<e&&(a*=256);)i+=this[t+u]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*e)),i};x.prototype.readIntBE=function(t,e,n){t=t>>>0,e=e>>>0,n||Z(t,e,this.length);let i=e,a=1,u=this[t+--i];for(;i>0&&(a*=256);)u+=this[t+--i]*a;return a*=128,u>=a&&(u-=Math.pow(2,8*e)),u};x.prototype.readInt8=function(t,e){return t=t>>>0,e||Z(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]};x.prototype.readInt16LE=function(t,e){t=t>>>0,e||Z(t,2,this.length);let n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};x.prototype.readInt16BE=function(t,e){t=t>>>0,e||Z(t,2,this.length);let n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};x.prototype.readInt32LE=function(t,e){return t=t>>>0,e||Z(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};x.prototype.readInt32BE=function(t,e){return t=t>>>0,e||Z(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};x.prototype.readBigInt64LE=Lt(function(t){t=t>>>0,Wt(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&he(t,this.length-8);let i=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)});x.prototype.readBigInt64BE=Lt(function(t){t=t>>>0,Wt(t,"offset");let e=this[t],n=this[t+7];(e===void 0||n===void 0)&&he(t,this.length-8);let i=(e<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n)});x.prototype.readFloatLE=function(t,e){return t=t>>>0,e||Z(t,4,this.length),zt.read(this,t,!0,23,4)};x.prototype.readFloatBE=function(t,e){return t=t>>>0,e||Z(t,4,this.length),zt.read(this,t,!1,23,4)};x.prototype.readDoubleLE=function(t,e){return t=t>>>0,e||Z(t,8,this.length),zt.read(this,t,!0,52,8)};x.prototype.readDoubleBE=function(t,e){return t=t>>>0,e||Z(t,8,this.length),zt.read(this,t,!1,52,8)};function it(r,t,e,n,i,a){if(!x.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(e+n>r.length)throw new RangeError("Index out of range")}x.prototype.writeUintLE=x.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e=e>>>0,n=n>>>0,!i){let y=Math.pow(2,8*n)-1;it(this,t,e,n,y,0)}let a=1,u=0;for(this[e]=t&255;++u<n&&(a*=256);)this[e+u]=t/a&255;return e+n};x.prototype.writeUintBE=x.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e=e>>>0,n=n>>>0,!i){let y=Math.pow(2,8*n)-1;it(this,t,e,n,y,0)}let a=n-1,u=1;for(this[e+a]=t&255;--a>=0&&(u*=256);)this[e+a]=t/u&255;return e+n};x.prototype.writeUint8=x.prototype.writeUInt8=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,1,255,0),this[e]=t&255,e+1};x.prototype.writeUint16LE=x.prototype.writeUInt16LE=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2};x.prototype.writeUint16BE=x.prototype.writeUInt16BE=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2};x.prototype.writeUint32LE=x.prototype.writeUInt32LE=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4};x.prototype.writeUint32BE=x.prototype.writeUInt32BE=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};function Kn(r,t,e,n,i){Xn(t,n,i,r,e,7);let a=Number(t&BigInt(4294967295));r[e++]=a,a=a>>8,r[e++]=a,a=a>>8,r[e++]=a,a=a>>8,r[e++]=a;let u=Number(t>>BigInt(32)&BigInt(4294967295));return r[e++]=u,u=u>>8,r[e++]=u,u=u>>8,r[e++]=u,u=u>>8,r[e++]=u,e}function jn(r,t,e,n,i){Xn(t,n,i,r,e,7);let a=Number(t&BigInt(4294967295));r[e+7]=a,a=a>>8,r[e+6]=a,a=a>>8,r[e+5]=a,a=a>>8,r[e+4]=a;let u=Number(t>>BigInt(32)&BigInt(4294967295));return r[e+3]=u,u=u>>8,r[e+2]=u,u=u>>8,r[e+1]=u,u=u>>8,r[e]=u,e+8}x.prototype.writeBigUInt64LE=Lt(function(t,e=0){return Kn(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))});x.prototype.writeBigUInt64BE=Lt(function(t,e=0){return jn(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))});x.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e=e>>>0,!i){let E=Math.pow(2,8*n-1);it(this,t,e,n,E-1,-E)}let a=0,u=1,y=0;for(this[e]=t&255;++a<n&&(u*=256);)t<0&&y===0&&this[e+a-1]!==0&&(y=1),this[e+a]=(t/u>>0)-y&255;return e+n};x.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e=e>>>0,!i){let E=Math.pow(2,8*n-1);it(this,t,e,n,E-1,-E)}let a=n-1,u=1,y=0;for(this[e+a]=t&255;--a>=0&&(u*=256);)t<0&&y===0&&this[e+a+1]!==0&&(y=1),this[e+a]=(t/u>>0)-y&255;return e+n};x.prototype.writeInt8=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1};x.prototype.writeInt16LE=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2};x.prototype.writeInt16BE=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2};x.prototype.writeInt32LE=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4};x.prototype.writeInt32BE=function(t,e,n){return t=+t,e=e>>>0,n||it(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};x.prototype.writeBigInt64LE=Lt(function(t,e=0){return Kn(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});x.prototype.writeBigInt64BE=Lt(function(t,e=0){return jn(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Gn(r,t,e,n,i,a){if(e+n>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function zn(r,t,e,n,i){return t=+t,e=e>>>0,i||Gn(r,t,e,4,34028234663852886e22,-34028234663852886e22),zt.write(r,t,e,n,23,4),e+4}x.prototype.writeFloatLE=function(t,e,n){return zn(this,t,e,!0,n)};x.prototype.writeFloatBE=function(t,e,n){return zn(this,t,e,!1,n)};function Wn(r,t,e,n,i){return t=+t,e=e>>>0,i||Gn(r,t,e,8,17976931348623157e292,-17976931348623157e292),zt.write(r,t,e,n,52,8),e+8}x.prototype.writeDoubleLE=function(t,e,n){return Wn(this,t,e,!0,n)};x.prototype.writeDoubleBE=function(t,e,n){return Wn(this,t,e,!1,n)};x.prototype.copy=function(t,e,n,i){if(!x.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);let a=i-n;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,n,i):Uint8Array.prototype.set.call(t,this.subarray(n,i),e),a};x.prototype.fill=function(t,e,n,i){if(typeof t=="string"){if(typeof e=="string"?(i=e,e=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!x.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(t.length===1){let u=t.charCodeAt(0);(i==="utf8"&&u<128||i==="latin1")&&(t=u)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e=e>>>0,n=n===void 0?this.length:n>>>0,t||(t=0);let a;if(typeof t=="number")for(a=e;a<n;++a)this[a]=t;else{let u=x.isBuffer(t)?t:x.from(t,i),y=u.length;if(y===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(a=0;a<n-e;++a)this[a+e]=u[a%y]}return this};var Gt={};function Cr(r,t,e){Gt[r]=class extends e{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}Cr("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Cr("ERR_INVALID_ARG_TYPE",function(r,t){return`The "${r}" argument must be of type number. Received type ${typeof t}`},TypeError);Cr("ERR_OUT_OF_RANGE",function(r,t,e){let n=`The value of "${r}" is out of range.`,i=e;return Number.isInteger(e)&&Math.abs(e)>2**32?i=Dn(String(e)):typeof e=="bigint"&&(i=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(i=Dn(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);function Dn(r){let t="",e=r.length,n=r[0]==="-"?1:0;for(;e>=n+4;e-=3)t=`_${r.slice(e-3,e)}${t}`;return`${r.slice(0,e)}${t}`}function As(r,t,e){Wt(t,"offset"),(r[t]===void 0||r[t+e]===void 0)&&he(t,r.length-(e+1))}function Xn(r,t,e,n,i,a){if(r>e||r<t){let u=typeof t=="bigint"?"n":"",y;throw a>3?t===0||t===BigInt(0)?y=`>= 0${u} and < 2${u} ** ${(a+1)*8}${u}`:y=`>= -(2${u} ** ${(a+1)*8-1}${u}) and < 2 ** ${(a+1)*8-1}${u}`:y=`>= ${t}${u} and <= ${e}${u}`,new Gt.ERR_OUT_OF_RANGE("value",y,r)}As(n,i,a)}function Wt(r,t){if(typeof r!="number")throw new Gt.ERR_INVALID_ARG_TYPE(t,"number",r)}function he(r,t,e){throw Math.floor(r)!==r?(Wt(r,e),new Gt.ERR_OUT_OF_RANGE(e||"offset","an integer",r)):t<0?new Gt.ERR_BUFFER_OUT_OF_BOUNDS:new Gt.ERR_OUT_OF_RANGE(e||"offset",`>= ${e?1:0} and <= ${t}`,r)}var _s=/[^+/0-9A-Za-z-_]/g;function bs(r){if(r=r.split("=")[0],r=r.trim().replace(_s,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Rr(r,t){t=t||1/0;let e,n=r.length,i=null,a=[];for(let u=0;u<n;++u){if(e=r.charCodeAt(u),e>55295&&e<57344){if(!i){if(e>56319){(t-=3)>-1&&a.push(239,191,189);continue}else if(u+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=e;continue}if(e<56320){(t-=3)>-1&&a.push(239,191,189),i=e;continue}e=(i-55296<<10|e-56320)+65536}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,e<128){if((t-=1)<0)break;a.push(e)}else if(e<2048){if((t-=2)<0)break;a.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;a.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;a.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return a}function Ss(r){let t=[];for(let e=0;e<r.length;++e)t.push(r.charCodeAt(e)&255);return t}function Is(r,t){let e,n,i,a=[];for(let u=0;u<r.length&&!((t-=2)<0);++u)e=r.charCodeAt(u),n=e>>8,i=e%256,a.push(i),a.push(n);return a}function Jn(r){return Ur.toByteArray(bs(r))}function Oe(r,t,e,n){let i;for(i=0;i<n&&!(i+e>=t.length||i>=r.length);++i)t[i+e]=r[i];return i}function yt(r,t){return r instanceof t||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===t.name}function Fr(r){return r!==r}var Us=function(){let r="0123456789abcdef",t=new Array(256);for(let e=0;e<16;++e){let n=e*16;for(let i=0;i<16;++i)t[n+i]=r[e]+r[i]}return t}();function Lt(r){return typeof BigInt>"u"?Ls:r}function Ls(){throw new Error("BigInt not supported")}});var Yn=D((ba,Vn)=>{window.global=window;global.fetch=window.fetch;Vn.exports={Buffer:Pr().Buffer,Crypto:window.crypto}});var vr={};ci(vr,{AVSCTap:()=>jt,ArweaveSigner:()=>Ct,DataItem:()=>mt,InjectedArweaveSigner:()=>Dr,MAX_TAG_BYTES:()=>Ne,MIN_BINARY_SIZE:()=>Qn,Signer:()=>Me,createData:()=>Ns,deserializeTags:()=>Le,indexToType:()=>Ve,serializeTags:()=>br,tagsExceedLimit:()=>is});var Me=class{signer;publicKey;signatureType;signatureLength;ownerLength;pem;static verify(t,e,n,i){throw new Error("You must implement verify method on child")}};var en=Bt(Yt(),1);var tt=Bt(pt(),1);async function ye(r){if(Array.isArray(r)){let i=(0,tt.concatBuffers)([(0,tt.stringToBuffer)("list"),(0,tt.stringToBuffer)(r.length.toString())]);return await tn(r,await at().hash(i,"SHA-384"))}let t=r,e=(0,tt.concatBuffers)([(0,tt.stringToBuffer)("blob"),(0,tt.stringToBuffer)(t.byteLength.toString())]),n=(0,tt.concatBuffers)([await at().hash(e,"SHA-384"),await at().hash(t,"SHA-384")]);return await at().hash(n,"SHA-384")}async function tn(r,t){if(r.length<1)return t;let e=(0,tt.concatBuffers)([t,await ye(r[0])]),n=await at().hash(e,"SHA-384");return await tn(r.slice(1),n)}var me=Bt(Xe(),1),bi=me.default.default?me.default.default:me.default,Je=class extends bi{getPublicKey(t){throw new Error("Unimplemented")}},Si;function at(){return Si??=new Je}var rt;(function(r){r[r.ARWEAVE=1]="ARWEAVE",r[r.ED25519=2]="ED25519",r[r.ETHEREUM=3]="ETHEREUM",r[r.SOLANA=4]="SOLANA",r[r.INJECTEDAPTOS=5]="INJECTEDAPTOS",r[r.MULTIAPTOS=6]="MULTIAPTOS",r[r.TYPEDETHEREUM=7]="TYPEDETHEREUM"})(rt||(rt={}));var Tt={[rt.ARWEAVE]:{sigLength:512,pubLength:512,sigName:"arweave"},[rt.ED25519]:{sigLength:64,pubLength:32,sigName:"ed25519"},[rt.ETHEREUM]:{sigLength:65,pubLength:65,sigName:"ethereum"},[rt.SOLANA]:{sigLength:64,pubLength:32,sigName:"solana"},[rt.INJECTEDAPTOS]:{sigLength:64,pubLength:32,sigName:"injectedAptos"},[rt.MULTIAPTOS]:{sigLength:64*32+4,pubLength:32*32+1,sigName:"multiAptos"},[rt.TYPEDETHEREUM]:{sigLength:65,pubLength:42,sigName:"typedEthereum"}};var Ct=class{signatureType=1;ownerLength=Tt[1].pubLength;signatureLength=Tt[1].sigLength;jwk;pk;constructor(t){this.pk=t.n,this.jwk=t}get publicKey(){return en.default.toBuffer(this.pk)}sign(t){return at().sign(this.jwk,t)}static async verify(t,e,n){return await at().verify(t,e,n)}};var Ve={1:Ct};var ti=Bt(Nn(),1),ei=Bt(Yt(),1);var gt=Bt(Yt(),1);async function fe(r){return ye([(0,tt.stringToBuffer)("dataitem"),(0,tt.stringToBuffer)("1"),(0,tt.stringToBuffer)(r.signatureType.toString()),r.rawOwner,r.rawTarget,r.rawAnchor,r.rawTags,r.rawData])}async function ns(r,t){let e=await fe(r),n=await t.sign(e),i=await at().hash(n);return{signature:Buffer.from(n),id:Buffer.from(i)}}async function Rn(r,t){let{signature:e,id:n}=await ns(r,t);return r.getRaw().set(e,2),n}var jt=class{buf;pos;constructor(t=Buffer.alloc(Ne),e=0){this.buf=t,this.pos=e}writeTags(t){if(!Array.isArray(t))throw new Error("input must be array");let e=t.length,n;if(e)for(this.writeLong(e),n=0;n<e;n++){let i=t[n];if(i?.name===void 0||i?.value===void 0)throw new Error(`Invalid tag format for ${i}, expected {name:string, value: string}`);this.writeString(i.name),this.writeString(i.value)}this.writeLong(0)}toBuffer(){let t=Buffer.alloc(this.pos);if(this.pos>this.buf.length)throw new Error(`Too many tag bytes (${this.pos} > ${this.buf.length})`);return this.buf.copy(t,0,0,this.pos),t}tagsExceedLimit(){return this.pos>this.buf.length}writeLong(t){let e=this.buf,n,i;if(t>=-1073741824&&t<1073741824){i=t>=0?t<<1:~t<<1|1;do e[this.pos]=i&127,i>>=7;while(i&&(e[this.pos++]|=128))}else{n=t>=0?t*2:-t*2-1;do e[this.pos]=n&127,n/=128;while(n>=1&&(e[this.pos++]|=128))}this.pos++,this.buf=e}writeString(t){let e=Buffer.byteLength(t),n=this.buf;this.writeLong(e);let i=this.pos;if(this.pos+=e,!(this.pos>n.length)){if(e>64)this.buf.write(t,this.pos-e,e,"utf8");else{let a,u,y,E;for(a=0,u=e;a<u;a++)y=t.charCodeAt(a),y<128?n[i++]=y:y<2048?(n[i++]=y>>6|192,n[i++]=y&63|128):(y&64512)===55296&&((E=t.charCodeAt(a+1))&64512)===56320?(y=65536+((y&1023)<<10)+(E&1023),a++,n[i++]=y>>18|240,n[i++]=y>>12&63|128,n[i++]=y>>6&63|128,n[i++]=y&63|128):(n[i++]=y>>12|224,n[i++]=y>>6&63|128,n[i++]=y&63|128)}this.buf=n}}readLong(){let t=0,e=0,n=this.buf,i,a,u,y;do i=n[this.pos++],a=i&128,t|=(i&127)<<e,e+=7;while(a&&e<28);if(a){u=t,y=268435456;do i=n[this.pos++],u+=(i&127)*y,y*=128;while(i&128);return(u%2?-(u+1):u)/2}return t>>1^-(t&1)}skipLong(){let t=this.buf;for(;t[this.pos++]&128;);}readTags(){let t=[],e;for(;e=this.readLong();)for(e<0&&(e=-e,this.skipLong());e--;){let n=this.readString(),i=this.readString();t.push({name:n,value:i})}return t}readString(){let t=this.readLong(),e=this.pos,n=this.buf;if(this.pos+=t,!(this.pos>n.length))return this.buf.slice(e,e+t).toString()}};function br(r){let t=new jt;return t.writeTags(r),t.toBuffer()}function is(r){let t=new jt;return t.writeTags(r),t.tagsExceedLimit()}function Le(r){return new jt(r).readTags()}function _t(r){let t=0;for(let e=r.length-1;e>=0;e--)t=t*256+r[e];return t}function On(r){if(r>(2^32-1))throw new Error("Short too long");let t=[0,0];for(let e=0;e<t.length;e++){let n=r&255;t[e]=n,r=(r-n)/256}return Uint8Array.from(t)}function Sr(r){let t=[0,0,0,0,0,0,0,0];for(let e=0;e<t.length;e++){let n=r&255;t[e]=n,r=(r-n)/256}return Uint8Array.from(t)}var Zn=Bt(Yn(),1),Pt=Bt(Pr(),1),Ne=4096,Qn=80,mt=class{binary;_id;constructor(t){this.binary=t}static isDataItem(t){return t.binary!==void 0}get signatureType(){let t=_t(this.binary.subarray(0,2));if(rt?.[t]!==void 0)return t;throw new Error("Unknown signature type: "+t)}async isValid(){return mt.verify(this.binary)}get id(){return(async()=>gt.default.encode(await this.rawId))()}set id(t){this._id=gt.default.toBuffer(t)}get rawId(){return(async()=>Pt.Buffer.from(await Zn.Crypto.subtle.digest("SHA-256",this.rawSignature)))()}set rawId(t){this._id=t}get rawSignature(){return this.binary.subarray(2,2+this.signatureLength)}get signature(){return gt.default.encode(this.rawSignature)}set rawOwner(t){if(t.byteLength!=this.ownerLength)throw new Error(`Expected raw owner (pubkey) to be ${this.ownerLength} bytes, got ${t.byteLength} bytes.`);this.binary.set(t,2+this.signatureLength)}get rawOwner(){return this.binary.subarray(2+this.signatureLength,2+this.signatureLength+this.ownerLength)}get signatureLength(){return Tt[this.signatureType].sigLength}get owner(){return gt.default.encode(this.rawOwner)}get ownerLength(){return Tt[this.signatureType].pubLength}get rawTarget(){let t=this.getTargetStart();return this.binary[t]==1?this.binary.subarray(t+1,t+33):Pt.Buffer.alloc(0)}get target(){return gt.default.encode(this.rawTarget)}get rawAnchor(){let t=this.getAnchorStart();return this.binary[t]==1?this.binary.subarray(t+1,t+33):Pt.Buffer.alloc(0)}get anchor(){return this.rawAnchor.toString()}get rawTags(){let t=this.getTagsStart(),e=_t(this.binary.subarray(t+8,t+16));return this.binary.subarray(t+16,t+16+e)}get tags(){let t=this.getTagsStart();if(_t(this.binary.subarray(t,t+8))==0)return[];let n=_t(this.binary.subarray(t+8,t+16));return Le(Pt.Buffer.from(this.binary.subarray(t+16,t+16+n)))}get tagsB64Url(){return this.tags.map(e=>({name:gt.default.encode(e.name),value:gt.default.encode(e.value)}))}getStartOfData(){let t=this.getTagsStart(),e=this.binary.subarray(t+8,t+16),n=_t(e);return t+16+n}get rawData(){let t=this.getTagsStart(),e=this.binary.subarray(t+8,t+16),n=_t(e),i=t+16+n;return this.binary.subarray(i,this.binary.length)}get data(){return gt.default.encode(this.rawData)}getRaw(){return this.binary}async sign(t){return this._id=await Rn(this,t),this.rawId}async setSignature(t){this.binary.set(t,2),this._id=Pt.Buffer.from(await at().hash(t))}isSigned(){return(this._id?.length??0)>0}toJSON(){return{signature:this.signature,owner:this.owner,target:this.target,tags:this.tags.map(t=>({name:gt.default.encode(t.name),value:gt.default.encode(t.value)})),data:this.data}}static async verify(t){if(t.byteLength<Qn)return!1;let e=new mt(t),n=e.signatureType,i=e.getTagsStart(),a=_t(t.subarray(i,i+8)),u=t.subarray(i+8,i+16),y=_t(u);if(y>Ne)return!1;if(a>0)try{if(Le(Pt.Buffer.from(t.subarray(i+16,i+16+y))).length!==a)return!1}catch{return!1}let E=Ve[n],b=await fe(e);return await E.verify(e.rawOwner,b,e.rawSignature)}async getSignatureData(){return fe(this)}getTagsStart(){let t=this.getTargetStart(),e=this.binary[t]==1,n=t+(e?33:1),i=this.binary[n]==1;return n+=i?33:1,n}getTargetStart(){return 2+this.signatureLength+this.ownerLength}getAnchorStart(){let t=this.getTargetStart()+1,e=this.binary[this.getTargetStart()]==1;return t+=e?32:0,t}};var Dr=class{signer;publicKey;ownerLength=Tt[rt.ARWEAVE].pubLength;signatureLength=Tt[rt.ARWEAVE].sigLength;signatureType=rt.ARWEAVE;constructor(t){this.signer=t}async setPublicKey(){let t;this.signer.getPublicKey?t=await this.signer.getPublicKey():t=await this.signer.getActivePublicKey(),this.publicKey=ei.default.toBuffer(t)}async sign(t){this.publicKey||await this.setPublicKey();let e={name:"RSA-PSS",saltLength:0},n=await this.signer.signature(t,e);return new Uint8Array(Object.values(n))}async signDataItem(t,e){return this.publicKey||await this.setPublicKey(),new mt(Buffer.from(await this.signer.signDataItem({data:t,tags:e})))}static async verify(t,e,n){return await ti.default.crypto.verify(t,e,n)}};var ri=Bt(Yt(),1);function Ns(r,t,e){let n=t.publicKey,i=e?.target?ri.default.toBuffer(e.target):null,a=1+(i?.byteLength??0),u=e?.anchor?Buffer.from(e.anchor):null,y=1+(u?.byteLength??0),E=(e?.tags?.length??0)>0?br(e.tags):null,b=16+(E?E.byteLength:0),I=Buffer.from(r),_=I.byteLength,C=2+t.signatureLength+t.ownerLength+a+y+b+_,F=Buffer.alloc(C);if(F.set(On(t.signatureType),0),F.set(new Uint8Array(t.signatureLength).fill(0),2),n.byteLength!==t.ownerLength)throw new Error(`Owner must be ${t.ownerLength} bytes, but was incorrectly ${n.byteLength}`);F.set(n,2+t.signatureLength);let G=2+t.signatureLength+t.ownerLength;if(F[G]=i?1:0,i){if(i.byteLength!==32)throw new Error(`Target must be 32 bytes but was incorrectly ${i.byteLength}`);F.set(i,G+1)}let V=G+a,ut=V+1;if(F[V]=u?1:0,u){if(ut+=u.byteLength,u.byteLength!==32)throw new Error("Anchor must be 32 bytes");F.set(u,V+1)}F.set(Sr(e?.tags?.length??0),ut);let v=Sr(E?.byteLength??0);F.set(v,ut+8),E&&F.set(E,ut+16);let Dt=ut+b;return F.set(I,Dt),new mt(F)}var Mr={...vr};globalThis.arbundles??=Mr;var Qa=Mr,to=Mr;export{jt as AVSCTap,Ct as ArweaveSigner,mt as DataItem,Dr as InjectedArweaveSigner,Ne as MAX_TAG_BYTES,Qn as MIN_BINARY_SIZE,Me as Signer,Ns as createData,Qa as default,Le as deserializeTags,Ve as indexToType,br as serializeTags,is as tagsExceedLimit,to as warparbundles};
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/
